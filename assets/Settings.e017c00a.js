import{_ as F,u as E,s as I,a as q,aQ as R,m as A,b as H,S as z,r as k,o as d,c as u,d as t,w as l,V as J,F as h,Q as y,R as K,L as S,A as L,O as M,br as W,j as r,t as a,J as V,aV as G,N as T,U as Q,e as c,G as j,E as v,z as m,H as f,h as b,I as p,bs as O,bt as C,g as N,bu as P,bv as B,B as U}from"./index.5084c8cb.js";import{g as X,c as Y,u as Z,V as $,a as ee,b as te}from"./VTable.6969dd58.js";import{V as se}from"./VSnackbar.40e2b9ba.js";import{b as le}from"./VTextField.3013ea0f.js";const{setBar:ie}=E(),ne={data(){return{items:[{text:"\u8BA2\u9605\u8BBE\u7F6E",icon:"mdi:mdi-rss"},{text:"\u63A8\u9001\u8BBE\u7F6E",icon:"mdi:mdi-send"},{text:"\u5FEB\u6377\u952E0",icon:"mdi:mdi-keyboard-settings"}],item:{},slider:{min:0,max:20},tip:{show:!1,msg:void 0},loading:!1,btnLoading:!1,settings:{itemsLimit:0,itemsTheme:0,email:"",follows:[]}}},setup(){const{token:o}=I(q()),{reloadFollow:n}=R(),{mobile:x}=A(),{t:i}=H();function s(g){return i("settings."+g)}return{mobile:x,token:o,reloadFollow:n,st:s,t:i}},components:{Skeleton:z},methods:{async initData(){this.loading=!0,await this.loadData(),this.loading=!1},async loadData(){let o=await X();o.follows.forEach(n=>{n.sort_copy=n.sort,n.folderName_copy=n.folderName}),this.settings=o},async save(o){this.btnLoading=!0,o=="rss"?await this.changeFollows():await this.update(),this.btnLoading=!1},async changeFollows(){try{let o=this.settings.follows.filter(n=>n.sort_copy!=n.sort||n.folderName_copy!=n.folderName);o.length&&(await Y(o),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData(),this.reloadFollow())}catch(o){console.log(o),this.tip.show=!0,this.tip.msg=this.t("errorTip")}},async update(){try{let o={itemsLimit:this.settings.itemsLimit,itemsTheme:this.settings.itemsTheme,enabledNewsletterSend:this.settings.enabledNewsletterSend};await Z(o),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData()}catch{this.tip.show=!0,this.tip.msg=this.t("errorTip")}},show(o){this.item=o}},mounted(){ie(this.st("appbar"),"mdi:mdi-cog"),this.token&&this.initData(),this.items=[{id:"newsletter",text:"pushSeting",icon:"mdi:mdi-email"},{id:"rss",text:"rssSeting",icon:"mdi:mdi-rss"},{id:"keyborad",text:"quickKeyboard",icon:"mdi:mdi-keyboard-settings"}],this.item=this.items[0]}},ae={class:"flex pr-4"},oe=["textContent"],de=["href"],re=["onUpdate:modelValue"],me=["onUpdate:modelValue"],ue={key:1,class:"my-6 mx-auto text-center"},ce=r(" 7:00-12:00 "),he=["innerHTML"];function fe(o,n,x,i,s,g){const D=k("router-link"),w=k("skeleton");return d(),u(h,null,[t(J,{dense:""},{default:l(()=>[y(t(S,{xl:3,lg:4,md:6,sm:12},{default:l(()=>[t(L,{class:"text"},{default:l(()=>[t(M,null,{default:l(()=>[t(W,null,{default:l(()=>[r(a(i.st("title")),1)]),_:1}),(d(!0),u(h,null,V(s.items,(e,_)=>(d(),c(T,{key:_,value:i.st(e.text),onClick:pe=>g.show(e)},{prepend:l(()=>[t(v,{icon:e.icon},null,8,["icon"])]),default:l(()=>[t(P,{textContent:a(i.st(e.text))},null,8,["textContent"])]),_:2},1032,["value","onClick"]))),128)),t(G),t(T,{"prepend-icon":"far fa-circle-question",title:i.st("feedback"),target:"_blank",href:"https://docs.qq.com/sheet/DSFhscEJ0cEFKWW9W?tab=BB08J2"},null,8,["title"])]),_:1})]),_:1})]),_:1},512),[[K,!(i.mobile&&s.item.text)]]),t(Q,{name:"list"},{default:l(()=>[s.item.text?(d(),c(S,{key:0,xl:9,lg:8,md:6,sm:12},{default:l(()=>[t(L,{class:"py-3"},{default:l(()=>[t(j,{class:"mb-3"},{default:l(()=>[t(v,{icon:s.item.icon,class:"mr-3"},null,8,["icon"]),r(" "+a(i.st(s.item.text)),1)]),_:1}),s.item.id=="rss"?(d(),u(h,{key:0},[m("div",ae,[t(f,null,{default:l(()=>[r(a(i.st("rssSubTitle")),1)]),_:1}),t(b,{color:"primary",to:"/setup",variant:"outlined",title:i.st("rssAddBtn"),size:"small","prepend-icon":"fas fa-plus"},{default:l(()=>[r(a(i.st("rssAddBtn")),1)]),_:1},8,["title"])]),t(p,null,{default:l(()=>[s.settings.follows.length?(d(),c($,{key:0,"fixed-header":"",height:"calc(100vh - 280px)"},{default:l(()=>[m("thead",null,[m("tr",null,[(d(!0),u(h,null,V(i.st("rssTableCols"),e=>(d(),u("th",{class:"text-left",key:e,textContent:a(e)},null,8,oe))),128))])]),m("tbody",null,[(d(!0),u(h,null,V(s.settings.follows,e=>(d(),u("tr",{key:e.name},[m("td",null,a(e.channelName),1),m("td",null,[m("a",{target:"_blank",href:e.rssUrl,title:"\u67E5\u770Brss"},a(e.rssUrl),9,de)]),m("td",null,[y(m("input",{type:"text","onUpdate:modelValue":_=>e.sort=_,class:U(["item-sort",{"item-change":e.sort!=e.sort_copy}])},null,10,re),[[B,e.sort]])]),m("td",null,[y(m("input",{type:"text","onUpdate:modelValue":_=>e.folderName=_,class:U(["item-sort",{"item-change":e.folderName!=e.folderName_copy}])},null,10,me),[[B,e.folderName]])])]))),128))])]),_:1})):(d(),u("div",ue,[t(D,{to:"/setup"},{default:l(()=>[r(a(i.st("rssEmptyTip")),1)]),_:1})]))]),_:1}),s.loading?(d(),c(w,{key:1,class:"ma-3",width:"64px",height:"36px"})):(d(),c(b,{key:0,loading:s.btnLoading,class:"ma-3",color:"primary",onClick:n[0]||(n[0]=e=>g.save("rss")),disabled:i.token?s.settings.follows.filter(e=>e.sort_copy!=e.sort||e.folderName_copy!=e.folderName).length==0:!0},{default:l(()=>[r(a(i.token?i.st("comfirmBtn"):i.st("noLoginBtn")),1)]),_:1},8,["loading","disabled"]))],64)):s.item.id=="newsletter"?(d(),u(h,{key:1},[t(f,null,{default:l(()=>[r(a(i.st("pushEmail")),1)]),_:1}),t(p,{class:"px-6"},{default:l(()=>[r(a(s.settings.email),1)]),_:1}),t(f,null,{default:l(()=>[r(a(i.st("pushTime")),1)]),_:1}),t(p,{class:"px-6"},{default:l(()=>[ce]),_:1}),t(f,null,{default:l(()=>[r(a(i.st("pushView")),1)]),_:1}),t(p,null,{default:l(()=>[t(O,{modelValue:s.settings.itemsTheme,"onUpdate:modelValue":n[1]||(n[1]=e=>s.settings.itemsTheme=e)},{default:l(()=>[t(C,{label:i.st("pushViewSimple"),value:0},null,8,["label"]),t(C,{label:i.st("pushViewDetails"),value:1},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:l(()=>[r(a(i.st("pushLimit")),1)]),_:1}),t(p,null,{default:l(()=>[t(ee,{modelValue:s.settings.itemsLimit,"onUpdate:modelValue":n[3]||(n[3]=e=>s.settings.itemsLimit=e),class:"align-center",max:s.slider.max,min:s.slider.min,step:1,"hide-details":""},{append:l(()=>[t(le,{modelValue:s.settings.itemsLimit,"onUpdate:modelValue":n[2]||(n[2]=e=>s.settings.itemsLimit=e),"hide-details":"","single-line":"",density:"compact",type:"number",style:{width:"70px"}},null,8,["modelValue"])]),_:1},8,["modelValue","max","min"])]),_:1}),t(f,null,{default:l(()=>[r(a(i.st("pushEnabled")),1)]),_:1}),t(p,{class:"px-6"},{default:l(()=>[t(te,{modelValue:s.settings.enabledNewsletterSend,"onUpdate:modelValue":n[4]||(n[4]=e=>s.settings.enabledNewsletterSend=e),"hide-details":"",inset:""},null,8,["modelValue"])]),_:1}),s.loading?(d(),c(w,{key:1,class:"ma-3",width:"64px",height:"36px"})):(d(),c(b,{key:0,loading:s.btnLoading,class:"ma-3",color:"primary",disabled:!i.token,onClick:g.save},{default:l(()=>[r(a(i.token?i.st("comfirmBtn"):i.st("noLoginBtn")),1)]),_:1},8,["loading","disabled","onClick"]))],64)):s.item.id=="keyborad"?(d(),u("div",{key:2,class:"pa-3 text-h",innerHTML:i.st("quickKeyboardHtml")},null,8,he)):N("",!0)]),_:1})]),_:1})):N("",!0)]),_:1})]),_:1}),t(se,{location:"top",timeout:5e3,modelValue:s.tip.show,"onUpdate:modelValue":n[5]||(n[5]=e=>s.tip.show=e)},{default:l(()=>[r(a(s.tip.msg),1)]),_:1},8,["modelValue"])],64)}const be=F(ne,[["render",fe],["__scopeId","data-v-a8de4a88"]]);export{be as default};
