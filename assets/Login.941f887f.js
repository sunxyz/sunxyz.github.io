import{V as S,a as F,l as U}from"./VLayout.a9bd498e.js";import{_ as E,a as I,aS as L,b as N,Y as A,q as r,v as D,o as u,c as H,d as t,w as l,F as P,bF as R,bG as j,H as q,A as V,t as c,bH as z,bI as G,B as J,e as m,J as _,I as K,j as p,h as M}from"./index.98bd2709.js";import{V as W}from"./VSnackbar.68b86e6d.js";import{b}from"./VTextField.2b749a75.js";const Y={setup(){const{setUserInfo:h}=I(),{reloadFollow:s}=L(),{t:y}=N();function e(d){return y("login."+d)}const v=A(),n=r(void 0),a=D({show:!1,text:void 0}),f=r(0),x=r(void 0),o=r(!1),i=r(void 0);let g="";async function w(){f.value==0?k():C()}async function k(){if(o.value=!0,n.value)try{i.value=e("tip.sendingEmal"),g=await F({email:n.value}),f.value=1,setTimeout(()=>{i.value=void 0},2e3),o.value=!1}catch{a.text=e("tip.sendErr"),a.show=!0,o.value=!1}else a.text=e("tip.sendCheck"),a.show=!0,o.value=!1}async function C(){if(o.value=!0,x.value)try{i.value=e("tip.logining");let d=await U({key:g,code:x.value});T(d,()=>{setTimeout(()=>{v.push("/")},2e3)}),i.value=e("tip.loginSuc"),o.value=!1}catch{a.text=e("tip.loginErr"),a.show=!0,o.value=!1}else a.text=e("tip.codeCheck"),a.show=!0,o.value=!1}async function T(d,B){h({username:n.value},d),s(),B()}return{step:f,email:n,code:x,tip:a,loading:o,authText:i,loginSubmit:w,st:e}}},O={style:{display:"flex","align-items":"end"}},Q=V("div",{class:"mr-6"},"WebFollow",-1);function X(h,s,y,e,v,n){return u(),H(P,null,[t(S,null,{default:l(()=>[t(R,{color:"primary",density:"prominent"},{default:l(()=>[t(j,{class:"mx-auto","max-width":"1024px"},{default:l(()=>[t(q,{class:"mt-6"},{default:l(()=>[V("div",O,[Q,V("small",null,c(e.st("title")),1)])]),_:1})]),_:1})]),_:1}),t(z,null,{default:l(()=>[t(G,null,{default:l(()=>[t(J,{"max-width":"480px",class:"mx-auto",style:{"margin-top":"-36px","z-index":"10000"}},{default:l(()=>[e.authText?(u(),m(_,{key:0,textContent:c(e.authText),class:"my-12 text-align"},null,8,["textContent"])):(u(),m(_,{key:1},{default:l(()=>[t(K,{class:"mt-3"},{default:l(()=>[p(c(e.st("subTitle")),1)]),_:1}),e.step==0?(u(),m(b,{key:0,"hide-details":"auto",label:e.st("email"),placeholder:e.st("emailPlaceholder"),type:"email",class:"my-4",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=a=>e.email=a)},null,8,["label","placeholder","modelValue"])):(u(),m(b,{key:1,"hide-details":"auto",label:e.st("code"),placeholder:e.st("codePlaceholder"),type:"text",class:"my-4",modelValue:e.code,"onUpdate:modelValue":s[1]||(s[1]=a=>e.code=a)},null,8,["label","placeholder","modelValue"])),t(M,{block:"",color:"primary",loading:e.loading,onClick:e.loginSubmit},{default:l(()=>[p(c(e.step==0?e.st("emailBtn"):e.st("loginBtn")),1)]),_:1},8,["loading","onClick"])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(W,{modelValue:e.tip.show,"onUpdate:modelValue":s[2]||(s[2]=a=>e.tip.show=a)},{default:l(()=>[p(c(e.tip.text),1)]),_:1},8,["modelValue"])],64)}const le=E(Y,[["render",X]]);export{le as default};
