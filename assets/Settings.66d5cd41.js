import{_ as F,u as E,s as q,l as I,aQ as R,m as A,a as H,S as K,r as w,o,c as u,b as e,w as i,V as z,F as h,Q as b,R as J,L as S,A as T,O as M,br as W,h as d,t as a,J as x,aV as G,N as L,U as Q,d as c,G as O,E as C,z as m,H as f,g as V,I as p,bs as j,bt as v,e as N,bu as P,bv as B,B as U}from"./index.d851babc.js";import{g as X,c as Y,u as Z,V as $,a as tt,b as et}from"./VTable.3582a21d.js";import{V as st}from"./VSnackbar.bf87abd4.js";import{b as lt}from"./VTextField.cbe81e38.js";const{setBar:it}=E(),nt={data(){return{items:[{text:"\u8BA2\u9605\u8BBE\u7F6E",icon:"mdi:mdi-rss"},{text:"\u63A8\u9001\u8BBE\u7F6E",icon:"mdi:mdi-send"},{text:"\u5FEB\u6377\u952E0",icon:"mdi:mdi-keyboard-settings"}],item:{},tab:"\u4F18\u5148\u7EA7",slider:{min:0,max:20},tip:{show:!1,msg:void 0},loading:!1,btnLoading:!1,settings:{itemsLimit:0,itemsTheme:0,email:"",follows:[]}}},setup(){const{token:r}=q(I()),{reloadFollow:n}=R(),{mobile:y}=A(),{t:l}=H();function s(g){return l("settings."+g)}return{mobile:y,token:r,reloadFollow:n,st:s,t:l}},components:{Skeleton:K},methods:{async initData(){this.loading=!0,await this.loadData(),this.loading=!1},async loadData(){let r=await X();r.follows.forEach(n=>{n.sort_copy=n.sort,n.folderName_copy=n.folderName}),this.settings=r},async save(){this.btnLoading=!0,this.tab==this.st("rssTableCols")[2]?await this.changeFollows():await this.update(),this.btnLoading=!1},async changeFollows(){try{let r=this.settings.follows.filter(n=>n.sort_copy!=n.sort||n.folderName_copy!=n.folderName);r.length&&(await Y(r),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData(),this.reloadFollow())}catch(r){console.log(r),this.tip.show=!0,this.tip.msg=this.t("errorTip")}},async update(){try{let r={itemsLimit:this.settings.itemsLimit,itemsTheme:this.settings.itemsTheme,enabledNewsletterSend:this.settings.enabledNewsletterSend};await Z(r),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData()}catch{this.tip.show=!0,this.tip.msg=this.t("errorTip")}},show(r){this.item=r}},mounted(){it(this.st("appbar"),"mdi:mdi-cog"),this.token&&this.initData(),this.items=[{text:this.st("rssSeting"),icon:"mdi:mdi-rss"},{text:this.st("pushSeting"),icon:"mdi:mdi-send"},{text:this.st("quickKeyboard"),icon:"mdi:mdi-keyboard-settings"}]}},at={class:"flex pr-4"},ot=["textContent"],rt=["href"],dt=["onUpdate:modelValue"],mt=["onUpdate:modelValue"],ut={key:1,class:"my-6 mx-auto text-center"},ct=d(" 7:00-12:00 "),ht=["innerHTML"];function ft(r,n,y,l,s,g){const D=w("router-link"),k=w("skeleton");return o(),u(h,null,[e(z,{dense:""},{default:i(()=>[b(e(S,{xl:3,lg:4,md:6,sm:12},{default:i(()=>[e(T,{class:"text"},{default:i(()=>[e(M,null,{default:i(()=>[e(W,null,{default:i(()=>[d(a(l.st("title")),1)]),_:1}),(o(!0),u(h,null,x(s.items,(t,_)=>(o(),c(L,{key:_,value:t.text,onClick:pt=>g.show(t)},{prepend:i(()=>[e(C,{icon:t.icon},null,8,["icon"])]),default:i(()=>[e(P,{textContent:a(t.text)},null,8,["textContent"])]),_:2},1032,["value","onClick"]))),128)),e(G),e(L,{"prepend-icon":"far fa-circle-question",title:l.st("feedback"),target:"_blank",href:"https://docs.qq.com/sheet/DSFhscEJ0cEFKWW9W?tab=BB08J2"},null,8,["title"])]),_:1})]),_:1})]),_:1},512),[[J,!(l.mobile&&s.item.text)]]),e(Q,{name:"list"},{default:i(()=>[s.item.text?(o(),c(S,{key:0,xl:9,lg:8,md:6,sm:12},{default:i(()=>[e(T,{class:"py-3"},{default:i(()=>[e(O,{class:"mb-3"},{default:i(()=>[e(C,{icon:s.item.icon,class:"mr-3"},null,8,["icon"]),d(" "+a(s.item.text),1)]),_:1}),s.item.text==l.st("rssSeting")?(o(),u(h,{key:0},[m("div",at,[e(f,null,{default:i(()=>[d(a(l.st("rssSubTitle")),1)]),_:1}),e(V,{color:"primary",to:"/setup",variant:"outlined",title:l.st("rssAddBtn"),size:"small","prepend-icon":"fas fa-plus"},{default:i(()=>[d(a(l.st("rssAddBtn")),1)]),_:1},8,["title"])]),e(p,null,{default:i(()=>[s.settings.follows.length?(o(),c($,{key:0,"fixed-header":"",height:"calc(100vh - 280px)"},{default:i(()=>[m("thead",null,[m("tr",null,[(o(!0),u(h,null,x(l.st("rssTableCols"),t=>(o(),u("th",{class:"text-left",key:t,textContent:a(t)},null,8,ot))),128))])]),m("tbody",null,[(o(!0),u(h,null,x(s.settings.follows,t=>(o(),u("tr",{key:t.name},[m("td",null,a(t.channelName),1),m("td",null,[m("a",{target:"_blank",href:t.rssUrl,title:"\u67E5\u770Brss"},a(t.rssUrl),9,rt)]),m("td",null,[b(m("input",{type:"text","onUpdate:modelValue":_=>t.sort=_,class:U(["item-sort",{"item-change":t.sort!=t.sort_copy}])},null,10,dt),[[B,t.sort]])]),m("td",null,[b(m("input",{type:"text","onUpdate:modelValue":_=>t.folderName=_,class:U(["item-sort",{"item-change":t.folderName!=t.folderName_copy}])},null,10,mt),[[B,t.folderName]])])]))),128))])]),_:1})):(o(),u("div",ut,[e(D,{to:"/setup"},{default:i(()=>[d(a(l.st("rssEmptyTip")),1)]),_:1})]))]),_:1}),s.loading?(o(),c(k,{key:1,class:"ma-3",width:"64px",height:"36px"})):(o(),c(V,{key:0,loading:s.btnLoading,class:"ma-3",color:"primary",onClick:g.save,disabled:l.token?s.tab==l.st("rssTableCols")[2]&&s.settings.follows.filter(t=>t.sort_copy!=t.sort||t.folderName_copy!=t.folderName).length==0:!0},{default:i(()=>[d(a(l.token?l.st("comfirmBtn"):l.st("noLoginBtn")),1)]),_:1},8,["loading","onClick","disabled"]))],64)):s.item.text==l.st("pushSeting")?(o(),u(h,{key:1},[e(f,null,{default:i(()=>[d(a(l.st("pushEmail")),1)]),_:1}),e(p,{class:"px-6"},{default:i(()=>[d(a(s.settings.email),1)]),_:1}),e(f,null,{default:i(()=>[d(a(l.st("pushTime")),1)]),_:1}),e(p,{class:"px-6"},{default:i(()=>[ct]),_:1}),e(f,null,{default:i(()=>[d(a(l.st("pushView")),1)]),_:1}),e(p,null,{default:i(()=>[e(j,{modelValue:s.settings.itemsTheme,"onUpdate:modelValue":n[0]||(n[0]=t=>s.settings.itemsTheme=t)},{default:i(()=>[e(v,{label:l.st("pushViewSimple"),value:0},null,8,["label"]),e(v,{label:l.st("pushViewDetails"),value:1},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),e(f,null,{default:i(()=>[d(a(l.st("pushLimit")),1)]),_:1}),e(p,null,{default:i(()=>[e(tt,{modelValue:s.settings.itemsLimit,"onUpdate:modelValue":n[2]||(n[2]=t=>s.settings.itemsLimit=t),class:"align-center",max:s.slider.max,min:s.slider.min,step:1,"hide-details":""},{append:i(()=>[e(lt,{modelValue:s.settings.itemsLimit,"onUpdate:modelValue":n[1]||(n[1]=t=>s.settings.itemsLimit=t),"hide-details":"","single-line":"",density:"compact",type:"number",style:{width:"70px"}},null,8,["modelValue"])]),_:1},8,["modelValue","max","min"])]),_:1}),e(f,null,{default:i(()=>[d(a(l.st("pushEnabled")),1)]),_:1}),e(p,{class:"px-6"},{default:i(()=>[e(et,{modelValue:s.settings.enabledNewsletterSend,"onUpdate:modelValue":n[3]||(n[3]=t=>s.settings.enabledNewsletterSend=t),"hide-details":"",inset:""},null,8,["modelValue"])]),_:1}),s.loading?(o(),c(k,{key:1,class:"ma-3",width:"64px",height:"36px"})):(o(),c(V,{key:0,loading:s.btnLoading,class:"ma-3",color:"primary",disabled:!l.token,onClick:g.save},{default:i(()=>[d(a(l.token?l.st("comfirmBtn"):l.st("noLoginBtn")),1)]),_:1},8,["loading","disabled","onClick"]))],64)):s.item.text==l.st("quickKeyboard")?(o(),u("div",{key:2,class:"pa-3 text-h",innerHTML:l.st("quickKeyboardHtml")},null,8,ht)):N("",!0)]),_:1})]),_:1})):N("",!0)]),_:1})]),_:1}),e(st,{location:"top",timeout:5e3,modelValue:s.tip.show,"onUpdate:modelValue":n[4]||(n[4]=t=>s.tip.show=t)},{default:i(()=>[d(a(s.tip.msg),1)]),_:1},8,["modelValue"])],64)}const Vt=F(nt,[["render",ft],["__scopeId","data-v-cc33bf9a"]]);export{Vt as default};
