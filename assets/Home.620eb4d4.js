import{_ as l,u as m,i,f as u,r as h,o as s,c,a as f,b as o,w as r,V as p,d,F as w,e as g,g as _}from"./index.4ba22a0a.js";import{f as $}from"./Reader.f7066894.js";import{_ as N,u as x}from"./IndexView.829ef5cc.js";import"./VSnackbar.9855e680.js";const{setBar:B}=m(),L={data:()=>({data:[],params:{source:void 0,folder:void 0,page:0,size:20},isLast:!0,loading:!0}),components:{IndexView:N},setup(){const a=i("currentViewName"),t=i("sortName");return{viewName:a,sortName:t}},mounted(){x(window,document.documentElement,()=>{this.loadMore()}),this.initData()},computed:{hideLoadMoreBtn(){return this.viewName=="column-view"}},methods:{async initData(){console.log(this.$route);let a="\u9996\u9875",t="mdi:mdi-home";this.$route.fullPath=="/"?(this.params.source="HOME",this.params.source=void 0,this.params.folder=void 0):this.$route.fullPath=="/explore"?(this.params.source="EXPLORE",a="\u63A2\u7D22",t="mdi:mdi-compass"):this.$route.path=="/folder"?(this.params.source="HOME",a=this.$route.query.name,this.params.folder=a,a=a=="root"?"\u8BA2\u9605\u6E90":a,t="mdi:mdi-folder-outline"):this.$route.fullPath=="/star"&&(a="\u6536\u85CF",t="mdi:mdi-star"),this.params.sort=void 0,this.sortName&&this.$route.fullPath!="/star"&&(this.params.sort=this.sortName+",desc"),B(a,t),this.params.page=0,this.data=await this.loadData()},async loadData(){this.loading=!0;let a=this.$route.fullPath.includes("star")?await $(this.params):await u(this.params);return this.loading=!1,this.isLast=a.last,a.content},async loadMore(){this.isLast||(this.params.page+=1,this.data=[...this.data,...await this.loadData()])}},watch:{$route(a){this.params.folder==a.query.name&&a.path=="/folder"||(this.data=[],this.loading=!0,this.initData())},sortName(){this.data=[],this.loading=!0,this.initData()}}},M=_(" \u52A0\u8F7D\u66F4\u591A ");function V(a,t,k,y,D,e){const n=h("index-view");return s(),c(w,null,[f(n,{data:a.data,"load-more":e.loadMore,loading:a.loading,"is-last":a.isLast,xl:3,lg:3,md:4,sm:6,xs:12},null,8,["data","load-more","loading","is-last"]),e.hideLoadMoreBtn?d("",!0):(s(),o(p,{key:0,class:"ma-3"},{default:r(()=>[a.isLast?d("",!0):(s(),o(g,{key:0,class:"mx-auto",onClick:e.loadMore},{default:r(()=>[M]),_:1},8,["onClick"]))]),_:1}))],64)}const A=l(L,[["render",V]]);export{A as default};
