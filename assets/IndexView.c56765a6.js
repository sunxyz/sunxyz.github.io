import{_ as U,r as R,o,c as v,d as l,w as i,F as C,J as $,e as k,K as N,L as B,g as w,j as D,t as g,V as F,M as I,m as z,S as O,z as f,D as P,N as M,O as j,p as V,P as K,Q,R as X,A as q,T as S,U as G,i as Y,n as L,W as Z,x as A,y as E,C as p,X as ee}from"./index.a0b644bf.js";import{R as T}from"./Reader.7faf7e27.js";const te={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}};function ae(t,d,n,a,b,c){const _=R("entry-card"),h=R("entry-card-skeleton"),s=R("c-dialog");return o(),v(C,null,[l(F,{dense:""},{default:i(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),k(B,N({key:e.id},t.$attrs),{default:i(()=>[l(_,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:x=>c.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(B,N({key:e},t.$attrs),{default:i(()=>[l(h)]),_:2},1040)),64)):w("",!0),!n.loading&&n.isLast?(o(),k(B,{key:1,xl:"12",class:"text-align pa-3"},{default:i(()=>[D(g(t.$vuetify.locale.t("notMoreBtn")),1)]),_:1})):w("",!0)]),_:1}),l(s,{"model-value":n.showReader,"onUpdate:modelValue":d[0]||(d[0]=e=>t.$emits("update:showReader",e))},{default:i(()=>[I(t.$slots,"default")]),_:3},8,["model-value"])],64)}const le=U(te,[["render",ae]]);const ne={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=z();return{mobile:t}},components:{Skeleton:O},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)},log(t){console.log(t),this.openRead(t.id)}}},oe={class:"grid-2-between"},se={class:"grid-2"},ie=["onClick"],de={class:"text-ellipsis mr-3 title"},re={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ue={key:0,style:{"font-size":"0.75em"}},ce={class:"flex"},he={key:0,class:"text-center pa-3"};function fe(t,d,n,a,b,c){const _=R("router-link"),h=R("skeleton"),s=R("c-dialog");return o(),v("div",null,[l(j,{density:"compact"},{default:i(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),k(M,{key:e.id,value:e.id,onClick:x=>c.openRead(e.id)},{default:i(()=>[f("div",oe,[f("div",se,[c.isChannel?w("",!0):(o(),k(_,{key:0,tabindex:"-1",style:P([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:i(()=>[D(g(e.channelName),1)]),_:2},1032,["style","to"])),f("div",{class:"grid-2 hover",onClick:x=>c.openRead(e.id)},[f("div",de,g(e.title),1),f("small",re,g(e.summary),1)],8,ie)]),a.mobile?w("",!0):(o(),v("small",ue,g(e.pubDate),1))])]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(M,{key:e,value:e},{default:i(()=>[f("div",ce,[l(h,{height:"0.8em",width:"70%"}),l(h,{height:"0.8em",width:"50px"})])]),_:2},1032,["value"])),64)):w("",!0)]),_:1}),!n.loading&&n.isLast?(o(),v("div",he,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0),l(s,{"model-value":n.showReader,"onUpdate:modelValue":d[0]||(d[0]=e=>t.$emits("update:showReader",e))},{default:i(()=>[I(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const me=U(ne,[["render",fe],["__scopeId","data-v-33d83b0b"]]);function _e(t,d,n=()=>{}){d=d||t;let a=!0;const b=V(0),c=V(0),_=V(0),h=V(!1);return K(t,"scroll",s=>{if(b.value=d.scrollTop,c.value=d.scrollHeight,_.value=d.clientHeight,a){let e=d.scrollTop+d.clientHeight+120>d.scrollHeight;e&&n(),h.value=e,a=!1}setTimeout(()=>{h.value=!1,a=!0},300)}),{scrollTop:b,scrollHeight:c,clientHeight:_,isScrollBottom:h}}const pe={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=z();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){_e(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:O},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"},isChannel(){return this.$route.fullPath.indexOf("channel")>0}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ye={ref:"channelRef"},ve=["onClick"],ge={style:{}},ke=["textContent"],we=["textContent"],xe={class:"flex"},Re={key:1},be=["textContent"],Ce={class:"item"},Ve={class:"flex"},$e={key:1,class:"text-center pa-3"},Be={class:"box"};function Ie(t,d,n,a,b,c){const _=R("router-link"),h=R("skeleton");return o(),k(F,{dense:""},{default:i(()=>[Q(l(B,{xl:3,lg:4,md:6,sm:12},{default:i(()=>[l(q,null,{default:i(()=>[f("div",ye,[I(t.$slots,"channel",{},void 0,!0)],512),l(j,{"select-strategy":"independent",ref:"listRef",variant:"text",class:"over-y",style:P({maxHeight:c.maxHeight}),density:"compact"},{default:i(()=>[(o(!0),v(C,null,$(n.data,s=>(o(),k(M,{class:"py-2",key:s.id,value:"article/"+s.id,onClick:e=>c.openRead(s.id)},{default:i(()=>[f("div",{class:"item",onClick:e=>c.openRead(s.id)},[l(S,{src:s.thumbnail?s.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),f("div",ge,[f("div",{textContent:g(s.title),style:{"font-size":"0.9em"}},null,8,ke),f("small",{style:{display:"block"},textContent:g(s.summary)},null,8,we),f("div",xe,[c.isChannel?(o(),v("span",Re)):(o(),k(_,{key:0,tabindex:"-1",style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+s.channelId},{default:i(()=>[D(g(s.channelName),1)]),_:2},1032,["to"])),f("small",{textContent:g(s.pubDate)},null,8,be)])])],8,ve)]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,s=>l(M,{class:"py-2",key:s},{default:i(()=>[f("div",Ce,[l(S,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),f("div",null,[l(h,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(h,{height:"0.7em",width:"calc(1oo% - 100px)"}),f("div",Ve,[l(h,{height:"0.6em",width:"100px"}),l(h,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):w("",!0),!n.loading&&n.isLast?(o(),v("div",$e,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[X,!(a.mobile&&n.showReader)]]),l(G,{name:"list"},{default:i(()=>[n.showReader?(o(),k(B,{key:0,xl:9,lg:8,md:6,sm:12},{default:i(()=>[f("div",Be,[I(t.$slots,"default",{},void 0,!0)])]),_:3})):w("",!0)]),_:3})]),_:3})}const Me=U(pe,[["render",Ie],["__scopeId","data-v-7742abe2"]]),Te={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const d=t,n=Y("currentViewName"),a=V({}),b=V(void 0),c=d.loadMore,_=L(()=>d.data),h=L(()=>d.loading),s=L(()=>d.isLast),e=Z();A(a,r=>{r.id&&(e.pushHash("/article/"+r.id),document.title=(r.title||"")+" | WebFollow")}),A(b,r=>{x(r)});async function x(r){a.value=await ee(r),a.value.id=r}const W=r=>{let u=a.value.id,m=r.length;for(let y=0;y<m;y++)if(r[y].id==u&&y>0)return r[y-1].id;return null};function J(r){let u=a.value.id,m=r.length;for(let y=0;y<m;y++){let H=r[y];if(H.id==u&&y+3>m&&c(),H.id==u&&y+1<m)return r[y+1].id}return null}return E(async r=>{let u;r.detail=="up"?u=W(_.value):r.detail=="down"&&(u=J(_.value)),u&&x(u)}),(r,u)=>p(n)=="cards-view"?(o(),k(le,N({key:0,loadMore:p(c),data:p(_),loading:p(h)},r.$attrs,{"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":u[1]||(u[1]=m=>a.value.id=m),onClickItemRead:x}),{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},16,["loadMore","data","loading","is-last","show-reader"])):p(n)=="title-only-view"?(o(),k(me,{key:1,loadMore:p(c),data:p(_),loading:p(h),"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":u[3]||(u[3]=m=>a.value.id=m),onClickItemRead:x},{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(o(),k(Me,{key:2,loadMore:p(c),data:p(_),loading:p(h),"show-reader":a.value.id,"is-last":p(s),onClickItemRead:x},{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=m=>a.value=m),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))}};export{Te as _,_e as u};
