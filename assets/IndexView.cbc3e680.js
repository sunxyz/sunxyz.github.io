import{_ as N,r as R,o,c as v,a as l,w as i,F as C,I as $,b as g,J as S,K as I,d as k,V as F,L as B,g as U,l as O,S as z,x as f,B as P,E as x,M as H,N as j,n as V,O as K,P as Q,Q as q,y as G,R as A,T as X,i as Y,m as M,U as Z,t as D,v as E,A as p,W as ee}from"./index.06059866.js";import{R as T}from"./Reader.605baebb.js";const te={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}},ae=U(" \u6CA1\u6709\u66F4\u591A\u4E86 ");function le(t,d,n,a,b,u){const _=R("entry-card"),h=R("entry-card-skeleton"),s=R("c-dialog");return o(),v(C,null,[l(F,{dense:""},{default:i(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),g(I,S({key:e.id},t.$attrs),{default:i(()=>[l(_,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:w=>u.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(I,S({key:e},t.$attrs),{default:i(()=>[l(h)]),_:2},1040)),64)):k("",!0),!n.loading&&n.isLast?(o(),g(I,{key:1,xl:"12",class:"text-align pa-3"},{default:i(()=>[ae]),_:1})):k("",!0)]),_:1}),l(s,{"model-value":n.showReader,"onUpdate:modelValue":d[0]||(d[0]=e=>t.$emits("update:showReader",e))},{default:i(()=>[B(t.$slots,"default")]),_:3},8,["model-value"])],64)}const ne=N(te,[["render",le]]);const oe={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=O();return{mobile:t}},components:{Skeleton:z},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)},log(t){console.log(t),this.openRead(t.id)}}},se={class:"grid-2-between"},ie={class:"grid-2"},de=["onClick"],re={class:"text-ellipsis mr-3 title"},ce={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ue={key:0,style:{"font-size":"0.75em"}},he={class:"flex"},fe={key:0,class:"text-center pa-3"};function me(t,d,n,a,b,u){const _=R("router-link"),h=R("skeleton"),s=R("c-dialog");return o(),v("div",null,[l(j,{density:"compact"},{default:i(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),g(H,{key:e.id,value:e.id,onClick:w=>u.openRead(e.id)},{default:i(()=>[f("div",se,[f("div",ie,[u.isChannel?k("",!0):(o(),g(_,{key:0,tabindex:"-1",style:P([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:i(()=>[U(x(e.channelName),1)]),_:2},1032,["style","to"])),f("div",{class:"grid-2 hover",onClick:w=>u.openRead(e.id)},[f("div",re,x(e.title),1),f("small",ce,x(e.summary),1)],8,de)]),a.mobile?k("",!0):(o(),v("small",ue,x(e.pubDate),1))])]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(H,{key:e,value:e},{default:i(()=>[f("div",he,[l(h,{height:"0.8em",width:"70%"}),l(h,{height:"0.8em",width:"50px"})])]),_:2},1032,["value"])),64)):k("",!0)]),_:1}),!n.loading&&n.isLast?(o(),v("div",fe,"\u6CA1\u6709\u66F4\u591A\u4E86")):k("",!0),l(s,{"model-value":n.showReader,"onUpdate:modelValue":d[0]||(d[0]=e=>t.$emits("update:showReader",e))},{default:i(()=>[B(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const _e=N(oe,[["render",me],["__scopeId","data-v-f8bd3e5f"]]);function pe(t,d,n=()=>{}){d=d||t;let a=!0;const b=V(0),u=V(0),_=V(0),h=V(!1);return K(t,"scroll",s=>{if(b.value=d.scrollTop,u.value=d.scrollHeight,_.value=d.clientHeight,a){let e=d.scrollTop+d.clientHeight+120>d.scrollHeight;e&&n(),h.value=e,a=!1}setTimeout(()=>{h.value=!1,a=!0},300)}),{scrollTop:b,scrollHeight:u,clientHeight:_,isScrollBottom:h}}const ye={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=O();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){pe(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:z},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"},isChannel(){return this.$route.fullPath.indexOf("channel")>0}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ve={ref:"channelRef"},ge=["onClick"],ke={style:{}},we=["textContent"],xe=["textContent"],Re={class:"flex"},be={key:1},Ce=["textContent"],Ve={class:"item"},$e={class:"flex"},Ie={key:1,class:"text-center pa-3"},Be={class:"box"};function He(t,d,n,a,b,u){const _=R("router-link"),h=R("skeleton");return o(),g(F,{dense:""},{default:i(()=>[Q(l(I,{xl:3,lg:4,md:6,sm:12},{default:i(()=>[l(G,null,{default:i(()=>[f("div",ve,[B(t.$slots,"channel",{},void 0,!0)],512),l(j,{"select-strategy":"independent",ref:"listRef",variant:"text",class:"over-y",style:P({maxHeight:u.maxHeight}),density:"compact"},{default:i(()=>[(o(!0),v(C,null,$(n.data,s=>(o(),g(H,{class:"py-2",key:s.id,value:"article/"+s.id,onClick:e=>u.openRead(s.id)},{default:i(()=>[f("div",{class:"item",onClick:e=>u.openRead(s.id)},[l(A,{src:s.thumbnail?s.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),f("div",ke,[f("div",{textContent:x(s.title),style:{"font-size":"0.9em"}},null,8,we),f("small",{style:{display:"block"},textContent:x(s.summary)},null,8,xe),f("div",Re,[u.isChannel?(o(),v("span",be)):(o(),g(_,{key:0,tabindex:"-1",style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+s.channelId},{default:i(()=>[U(x(s.channelName),1)]),_:2},1032,["to"])),f("small",{textContent:x(s.pubDate)},null,8,Ce)])])],8,ge)]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,s=>l(H,{class:"py-2",key:s},{default:i(()=>[f("div",Ve,[l(A,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),f("div",null,[l(h,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(h,{height:"0.7em",width:"calc(1oo% - 100px)"}),f("div",$e,[l(h,{height:"0.6em",width:"100px"}),l(h,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):k("",!0),!n.loading&&n.isLast?(o(),v("div",Ie,"\u6CA1\u6709\u66F4\u591A\u4E86")):k("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[q,!(a.mobile&&n.showReader)]]),l(X,{name:"list"},{default:i(()=>[n.showReader?(o(),g(I,{key:0,xl:9,lg:8,md:6,sm:12},{default:i(()=>[f("div",Be,[B(t.$slots,"default",{},void 0,!0)])]),_:3})):k("",!0)]),_:3})]),_:3})}const Le=N(ye,[["render",He],["__scopeId","data-v-5a7f73e8"]]),Ne={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const d=t,n=Y("currentViewName"),a=V({}),b=V(void 0),u=d.loadMore,_=M(()=>d.data),h=M(()=>d.loading),s=M(()=>d.isLast),e=Z();D(a,r=>{r.id&&(e.pushHash("/article/"+r.id),document.title=(r.title||"")+" | WebFollow")}),D(b,r=>{w(r)});async function w(r){a.value=await ee(r),a.value.id=r}const W=r=>{let c=a.value.id,m=r.length;for(let y=0;y<m;y++)if(r[y].id==c&&y>0)return r[y-1].id;return null};function J(r){let c=a.value.id,m=r.length;for(let y=0;y<m;y++){let L=r[y];if(L.id==c&&y+3>m&&u(),L.id==c&&y+1<m)return r[y+1].id}return null}return E(async r=>{let c;r.detail=="up"?c=W(_.value):r.detail=="down"&&(c=J(_.value)),c&&w(c)}),(r,c)=>p(n)=="cards-view"?(o(),g(ne,{key:0,loadMore:p(u),data:p(_),loading:p(h),"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":c[1]||(c[1]=m=>a.value.id=m),onClickItemRead:w},{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):p(n)=="title-only-view"?(o(),g(_e,{key:1,loadMore:p(u),data:p(_),loading:p(h),"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":c[3]||(c[3]=m=>a.value.id=m),onClickItemRead:w},{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(o(),g(Le,{key:2,loadMore:p(u),data:p(_),loading:p(h),"show-reader":a.value.id,"is-last":p(s),onClickItemRead:w},{default:i(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":c[4]||(c[4]=m=>a.value=m),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))}};export{Ne as _,pe as u};
