import{_ as N,r as x,o as d,c as w,a as l,w as n,F as R,G as b,b as v,H as U,I,d as V,V as z,J as H,K as L,S as A,v as c,L as O,g as S,B as k,M as $,N as P,m as C,O as j,P as W,Q as q,x as G,R as D,T as J,i as K,l as F,U as Q,q as X,t as Y,z as g,W as Z}from"./index.12b58c3a.js";import{R as T}from"./Reader.ba13f537.js";const E={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}};function ee(t,s,i,a,y,h){const f=x("entry-card"),m=x("entry-card-skeleton"),o=x("c-dialog");return d(),w(R,null,[l(z,{dense:""},{default:n(()=>[(d(!0),w(R,null,b(i.data,e=>(d(),v(I,U({key:e.id},t.$attrs),{default:n(()=>[l(f,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:B=>h.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),i.loading?(d(),w(R,{key:0},b(20,e=>l(I,U({key:e},t.$attrs),{default:n(()=>[l(m)]),_:2},1040)),64)):V("",!0)]),_:1}),l(o,{"model-value":i.showReader,"onUpdate:modelValue":s[0]||(s[0]=e=>t.$emits("update:showReader",e)),"max-width":"960","min-height":"calc(100vh - 48px)"},{default:n(()=>[H(t.$slots,"default")]),_:3},8,["model-value"])],64)}const te=N(E,[["render",ee]]);const ae={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=L();return{mobile:t}},components:{Skeleton:A},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)}}},le={class:"grid-2-between"},ne={class:"grid-2"},oe=["onClick"],se={class:"text-ellipsis mr-3 title"},de={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ie={key:0,style:{"font-size":"0.75em"}},re={class:"flex"};function ue(t,s,i,a,y,h){const f=x("router-link"),m=x("skeleton"),o=x("c-dialog");return d(),w("div",null,[l(P,{variant:"text"},{default:n(()=>[(d(!0),w(R,null,b(i.data,e=>(d(),v($,{key:e.id},{default:n(()=>[c("div",le,[c("div",ne,[h.isChannel?V("",!0):(d(),v(f,{key:0,style:O([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:n(()=>[S(k(e.channelName),1)]),_:2},1032,["style","to"])),c("div",{class:"grid-2 hover",onClick:B=>h.openRead(e.id)},[c("div",se,k(e.title),1),c("small",de,k(e.summary),1)],8,oe)]),a.mobile?V("",!0):(d(),w("small",ie,k(e.pubDate),1))])]),_:2},1024))),128)),i.loading?(d(),w(R,{key:0},b(20,e=>l($,{key:e},{default:n(()=>[c("div",re,[l(m,{height:"0.8em",width:"70%"}),l(m,{height:"0.8em",width:"50px"})])]),_:2},1024)),64)):V("",!0)]),_:1}),l(o,{"model-value":i.showReader,"onUpdate:modelValue":s[0]||(s[0]=e=>t.$emits("update:showReader",e)),"max-width":"960","min-height":"calc(100vh - 48px)"},{default:n(()=>[H(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const ce=N(ae,[["render",ue],["__scopeId","data-v-94ff183a"]]);function he(t,s,i=()=>{}){s=s||t;let a=!0;const y=C(0),h=C(0),f=C(0),m=C(!1);return j(t,"scroll",o=>{if(y.value=s.scrollTop,h.value=s.scrollHeight,f.value=s.clientHeight,a){let e=s.scrollTop+s.clientHeight+120>s.scrollHeight;e&&i(),m.value=e,a=!1}setTimeout(()=>{m.value=!1,a=!0},300)}),{scrollTop:y,scrollHeight:h,clientHeight:f,isScrollBottom:m}}const me={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=L();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){he(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:A},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},_e={ref:"channelRef"},fe=["onClick"],pe={style:{}},ge=["textContent"],ve=["textContent"],ye={class:"flex"},we=["textContent"],ke={class:"item"},xe={class:"flex"},Re=S(" \u7A7A\u7A7A\u5982\u4E5F "),Ve={class:"box"};function be(t,s,i,a,y,h){const f=x("router-link"),m=x("skeleton");return d(),v(z,{dense:""},{default:n(()=>[W(l(I,{xl:3,lg:4,md:6,sm:12},{default:n(()=>[l(G,null,{default:n(()=>[c("div",_e,[H(t.$slots,"channel",{},void 0,!0)],512),l(P,{ref:"listRef",variant:"text",class:"over-y",style:O({maxHeight:h.maxHeight})},{default:n(()=>[(d(!0),w(R,null,b(i.data,o=>(d(),v($,{class:"py-2",key:o.id},{default:n(()=>[c("div",{class:"item hover",onClick:e=>h.openRead(o.id)},[l(D,{src:o.thumbnail?o.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),c("div",pe,[c("div",{textContent:k(o.title),style:{"font-size":"0.9em"}},null,8,ge),c("small",{style:{display:"block"},textContent:k(o.summary)},null,8,ve),c("div",ye,[t.isChannel?V("",!0):(d(),v(f,{key:0,style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+o.channelId},{default:n(()=>[S(k(o.channelName),1)]),_:2},1032,["to"])),c("small",{textContent:k(o.pubDate)},null,8,we)])])],8,fe)]),_:2},1024))),128)),i.loading?(d(),w(R,{key:0},b(20,o=>l($,{class:"py-2",key:o},{default:n(()=>[c("div",ke,[l(D,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),c("div",null,[l(m,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(m,{height:"0.7em",width:"calc(1oo% - 100px)"}),c("div",xe,[l(m,{height:"0.6em",width:"100px"}),l(m,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):i.data.length==0?(d(),v($,{key:1},{default:n(()=>[Re]),_:1})):V("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[q,!(a.mobile&&i.showReader)]]),l(J,{name:"list"},{default:n(()=>[i.showReader?(d(),v(I,{key:0,xl:9,lg:8,md:6,sm:12},{default:n(()=>[c("div",Ve,[H(t.$slots,"default",{},void 0,!0)])]),_:3})):V("",!0)]),_:3})]),_:3})}const Ce=N(me,[["render",be],["__scopeId","data-v-89111dd1"]]),He={__name:"IndexView",props:["loadMore","data","loading"],setup(t){const s=t,i=K("currentViewName"),a=C({}),y=s.loadMore,h=F(()=>s.data),f=F(()=>s.loading),m=Q();X(a,r=>{r.id&&(m.pushHash("/article/"+r.id),document.title=(r.title||"")+" | WebFollow")});async function o(r){a.value=await Z(r),a.value.id=r}const e=r=>{let u=a.value.id,_=r.length;for(let p=0;p<_;p++)if(r[p].id==u&&p>0)return r[p-1].id;return null};function B(r){let u=a.value.id,_=r.length;for(let p=0;p<_;p++){let M=r[p];if(M.id==u&&p+3>_&&y(),M.id==u&&p+1<_)return r[p+1].id}return null}return Y(async r=>{let u;r.detail=="up"?u=e(h.value):r.detail=="down"&&(u=B(h.value)),u&&o(u)}),(r,u)=>g(i)=="cards-view"?(d(),v(te,{key:0,loadMore:g(y),data:g(h),loading:g(f),"show-reader":a.value.id,"onUpdate:show-reader":u[1]||(u[1]=_=>a.value.id=_),onClickItemRead:o},{default:n(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=_=>a.value=_)},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader"])):g(i)=="title-only-view"?(d(),v(ce,{key:1,loadMore:g(y),data:g(h),loading:g(f),"show-reader":a.value.id,onClickItemRead:o},{default:n(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=_=>a.value=_)},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader"])):(d(),v(Ce,{key:2,loadMore:g(y),data:g(h),loading:g(f),"show-reader":a.value.id,onClickItemRead:o},{default:n(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[3]||(u[3]=_=>a.value=_),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader"]))}};export{He as _,he as u};
