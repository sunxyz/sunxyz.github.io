import{V as B,a as S,l as F}from"./VLayout.3db6b469.js";import{_ as U,u as D,k as N,aQ as A,U as E,n as d,p as G,o as r,c as H,a as l,w as a,F as I,bF as L,bG as R,D as z,bH as K,bI as M,y as Q,b as c,E as x,H as _,G as W,e as j,g as y,x as p}from"./index.b6d40ad0.js";import{V as q}from"./VSnackbar.53b5e69c.js";import{b as g}from"./VTextField.bd3880e4.js";const J={setup(){const{setBar:V}=D(),{setUserInfo:n}=N(),{reloadFollow:v}=A(),e=E(),u=d(void 0),t=G({show:!1,text:void 0}),o=d(0),m=d(void 0),s=d(!1),i=d(void 0);V("\u767B\u9646");let h="";async function w(){o.value==0?b():k()}async function b(){if(s.value=!0,u.value)try{i.value="\u53D1\u9001\u4E2D...... \u8BF7\u6CE8\u610F\u67E5\u6536\u90AE\u4EF6",h=await S({email:u.value}),o.value=1,setTimeout(()=>{i.value=void 0},2e3),s.value=!1}catch{t.text="\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5!",t.show=!0,s.value=!1}else t.text="\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740",t.show=!0,s.value=!1}async function k(){if(s.value=!0,m.value)try{i.value="\u767B\u9646\u4E2D...... ";let f=await F({key:h,code:m.value});C(f,()=>{setTimeout(()=>{e.push("/")},2e3)}),i.value="\u767B\u9646\u6210\u529F\uFF0C\u6B63\u5728\u8DF3\u8F6C\u9996\u9875 ",s.value=!1}catch{t.text="\u767B\u9646\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5!",t.show=!0,s.value=!1}else t.text="\u8BF7\u8F93\u5165\u60A8\u7684\u9A8C\u8BC1\u7801",t.show=!0,s.value=!1}async function C(f,T){n({username:u.value},f),v(),T()}return{step:o,email:u,code:m,tip:t,loading:s,authText:i,loginSubmit:w}}},O=p("div",{style:{display:"flex","align-items":"end"}},[p("div",{class:"mr-6"},"WebFollow"),p("small",null,"\u767B\u9646")],-1),P=y("\u8BF7\u767B\u9646");function X(V,n,v,e,u,t){return r(),H(I,null,[l(B,null,{default:a(()=>[l(L,{color:"primary",density:"prominent"},{default:a(()=>[l(R,{class:"mx-auto","max-width":"1024px"},{default:a(()=>[l(z,{class:"mt-6"},{default:a(()=>[O]),_:1})]),_:1})]),_:1}),l(K,null,{default:a(()=>[l(M,null,{default:a(()=>[l(Q,{"max-width":"480px",class:"mx-auto",style:{"margin-top":"-36px","z-index":"10000"}},{default:a(()=>[e.authText?(r(),c(_,{key:0,textContent:x(e.authText),class:"my-12 text-align"},null,8,["textContent"])):(r(),c(_,{key:1},{default:a(()=>[l(W,{class:"mt-3"},{default:a(()=>[P]),_:1}),e.step==0?(r(),c(g,{key:0,"hide-details":"auto",label:"\u90AE\u7BB1\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740",type:"email",class:"my-4",modelValue:e.email,"onUpdate:modelValue":n[0]||(n[0]=o=>e.email=o)},null,8,["modelValue"])):(r(),c(g,{key:1,"hide-details":"auto",label:"\u9A8C\u8BC1\u7801",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u9A8C\u8BC1\u7801",type:"text",class:"my-4",modelValue:e.code,"onUpdate:modelValue":n[1]||(n[1]=o=>e.code=o)},null,8,["modelValue"])),l(j,{block:"",color:"primary",loading:e.loading,onClick:e.loginSubmit},{default:a(()=>[y(x(e.step==0?"\u83B7\u53D6\u9A8C\u8BC1\u7801":"\u767B\u9646"),1)]),_:1},8,["loading","onClick"])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),l(q,{modelValue:e.tip.show,"onUpdate:modelValue":n[2]||(n[2]=o=>e.tip.show=o)},{default:a(()=>[y(x(e.tip.text),1)]),_:1},8,["modelValue"])],64)}const ae=U(J,[["render",X]]);export{ae as default};
