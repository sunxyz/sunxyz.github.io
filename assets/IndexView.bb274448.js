import{_ as U,r as b,o as a,c as _,d as n,w as r,F as x,N as $,e as k,O as N,P as B,g as w,V as A,t as g,Q as I,q as F,S as O,C as h,H as z,j as P,R as H,T as j,x as V,U as G,W as Q,X,D as Y,Y as D,Z,i as J,v as L,p as K,A as S,B as E,G as y,$ as ee}from"./index.133edfec.js";import{R as T}from"./Reader.44e832af.js";const te={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}},le={key:0,class:"text-align pa-3"};function ae(t,i,o,l,C,f){const p=b("entry-card"),m=b("entry-card-skeleton"),s=b("c-dialog");return a(),_(x,null,[n(A,{dense:""},{default:r(()=>[(a(!0),_(x,null,$(o.data,e=>(a(),k(B,N({key:e.id},t.$attrs),{default:r(()=>[n(p,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:R=>f.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),o.loading?(a(),_(x,{key:0},$(20,e=>n(B,N({key:e},t.$attrs),{default:r(()=>[n(m)]),_:2},1040)),64)):w("",!0)]),_:1}),!o.loading&&o.isLast?(a(),_("div",le,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0),n(s,{"model-value":o.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:r(()=>[I(t.$slots,"default")]),_:3},8,["model-value"])],64)}const ne=U(te,[["render",ae]]);const oe={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=F();return{mobile:t}},components:{Skeleton:O},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)},log(t){console.log(t),this.openRead(t.id)}}},se={class:"grid-2-between"},ie={class:"grid-2"},de=["onClick"],re={class:"text-ellipsis mr-3 title"},ue={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ce={key:0,style:{"font-size":"0.75em"}},he={class:"flex"},fe={key:0,class:"text-center pa-3"};function me(t,i,o,l,C,f){const p=b("router-link"),m=b("skeleton"),s=b("c-dialog");return a(),_("div",null,[n(j,{density:"compact"},{default:r(()=>[(a(!0),_(x,null,$(o.data,e=>(a(),k(H,{key:e.id,value:e.id,onClick:R=>f.openRead(e.id)},{default:r(()=>[h("div",se,[h("div",ie,[f.isChannel?w("",!0):(a(),k(p,{key:0,tabindex:"-1",style:z([{display:"inline-block","font-size":"0.75em"},{width:l.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:r(()=>[P(g(e.channelName),1)]),_:2},1032,["style","to"])),h("div",{class:"grid-2 hover",onClick:R=>f.openRead(e.id)},[h("div",re,g(e.title),1),h("small",ue,g(e.summary),1)],8,de)]),l.mobile?w("",!0):(a(),_("small",ce,g(e.pubDate),1))])]),_:2},1032,["value","onClick"]))),128)),o.loading?(a(),_(x,{key:0},$(20,e=>n(H,{key:e,value:e},{default:r(()=>[h("div",he,[n(m,{height:"0.8em",width:"70%"}),n(m,{height:"0.8em",width:"50px"})])]),_:2},1032,["value"])),64)):w("",!0)]),_:1}),!o.loading&&o.isLast?(a(),_("div",fe,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0),n(s,{"model-value":o.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:r(()=>[I(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const _e=U(oe,[["render",me],["__scopeId","data-v-33d83b0b"]]);function pe(t,i,o=()=>{}){i=i||t;let l=!0;const C=V(0),f=V(0),p=V(0),m=V(!1);return G(t,"scroll",s=>{if(C.value=i.scrollTop,f.value=i.scrollHeight,p.value=i.clientHeight,l){let e=i.scrollTop+i.clientHeight+120>i.scrollHeight;e&&o(),m.value=e,l=!1}setTimeout(()=>{m.value=!1,l=!0},300)}),{scrollTop:C,scrollHeight:f,clientHeight:p,isScrollBottom:m}}const ye={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=F();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){pe(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:O},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"},isChannel(){return this.$route.fullPath.indexOf("channel")>0}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ve={ref:"channelRef"},ge=["onClick"],ke={style:{}},we=["textContent"],xe=["textContent"],Re={class:"flex"},be={key:1},Ce=["textContent"],$e={class:"item"},Ve={class:"flex"},Be={key:1,class:"text-center pa-3"},Ie={class:"box"};function He(t,i,o,l,C,f){const p=b("router-link"),m=b("skeleton");return a(),k(A,{dense:""},{default:r(()=>[Q(n(B,{xl:3,lg:4,md:6,sm:12},{default:r(()=>[n(Y,null,{default:r(()=>[h("div",ve,[I(t.$slots,"channel",{},void 0,!0)],512),n(j,{"select-strategy":"independent",ref:"listRef",variant:"text",class:"over-y",style:z({maxHeight:f.maxHeight}),density:"compact"},{default:r(()=>[(a(!0),_(x,null,$(o.data,s=>(a(),k(H,{class:"py-2",key:s.id,value:"article/"+s.id,onClick:e=>f.openRead(s.id)},{default:r(()=>[h("div",{class:"item",onClick:e=>f.openRead(s.id)},[n(D,{src:s.thumbnail?s.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),h("div",ke,[h("div",{textContent:g(s.title),style:{"font-size":"0.9em"}},null,8,we),h("small",{style:{display:"block"},textContent:g(s.summary)},null,8,xe),h("div",Re,[f.isChannel?(a(),_("span",be)):(a(),k(p,{key:0,tabindex:"-1",style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+s.channelId},{default:r(()=>[P(g(s.channelName),1)]),_:2},1032,["to"])),h("small",{textContent:g(s.pubDate)},null,8,Ce)])])],8,ge)]),_:2},1032,["value","onClick"]))),128)),o.loading?(a(),_(x,{key:0},$(20,s=>n(H,{class:"py-2",key:s},{default:r(()=>[h("div",$e,[n(D,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),h("div",null,[n(m,{height:"0.8em",width:"calc(1oo% - 100px)"}),n(m,{height:"0.7em",width:"calc(1oo% - 100px)"}),h("div",Ve,[n(m,{height:"0.6em",width:"100px"}),n(m,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):w("",!0),!o.loading&&o.isLast?(a(),_("div",Be,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[X,!(l.mobile&&o.showReader)]]),n(Z,{name:"list"},{default:r(()=>[o.showReader?(a(),k(B,{key:0,xl:9,lg:8,md:6,sm:12},{default:r(()=>[h("div",Ie,[I(t.$slots,"default",{},void 0,!0)])]),_:3})):w("",!0)]),_:3})]),_:3})}const Me=U(ye,[["render",He],["__scopeId","data-v-7742abe2"]]),Le={style:{display:"none"}},Te=["href","textContent"],De={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const i=t,o=J("currentViewName"),l=V({}),C=V(void 0),f=i.loadMore,p=L(()=>i.data),m=L(()=>i.loading),s=L(()=>i.isLast),e=K();S(l,d=>{d.id&&(e.pushHash("/article/"+d.id),document.title=(d.title||"")+" | WebFollow")}),S(C,d=>{R(d)});async function R(d){l.value=await ee(d),l.value.id=d}const W=d=>{let u=l.value.id,c=d.length;for(let v=0;v<c;v++)if(d[v].id==u&&v>0)return d[v-1].id;return null};function q(d){let u=l.value.id,c=d.length;for(let v=0;v<c;v++){let M=d[v];if(M.id==u&&v+3>c&&f(),M.id==u&&v+1<c)return d[v+1].id}return null}return E(async d=>{let u;d.detail=="up"?u=W(p.value):d.detail=="down"&&(u=q(p.value)),u&&R(u)}),(d,u)=>(a(),_(x,null,[h("ul",Le,[(a(!0),_(x,null,$(y(p),c=>(a(),_("li",{key:c.id},[h("a",{href:"/article/"+c.id,textContent:g(c.title)},null,8,Te)]))),128))]),y(o)=="cards-view"?(a(),k(ne,N({key:0,loadMore:y(f),data:y(p),loading:y(m)},d.$attrs,{"is-last":y(s),"show-reader":l.value.id,"onUpdate:show-reader":u[1]||(u[1]=c=>l.value.id=c),onClickItemRead:R}),{default:r(()=>[n(T,{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=c=>l.value=c),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},16,["loadMore","data","loading","is-last","show-reader"])):y(o)=="title-only-view"?(a(),k(_e,{key:1,loadMore:y(f),data:y(p),loading:y(m),"is-last":y(s),"show-reader":l.value.id,"onUpdate:show-reader":u[3]||(u[3]=c=>l.value.id=c),onClickItemRead:R},{default:r(()=>[n(T,{modelValue:l.value,"onUpdate:modelValue":u[2]||(u[2]=c=>l.value=c),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(a(),k(Me,{key:2,loadMore:y(f),data:y(p),loading:y(m),"show-reader":l.value.id,"is-last":y(s),onClickItemRead:R},{default:r(()=>[n(T,{modelValue:l.value,"onUpdate:modelValue":u[4]||(u[4]=c=>l.value=c),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))],64))}};export{De as _,pe as u};
