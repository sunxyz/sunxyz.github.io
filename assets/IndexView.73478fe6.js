import{_ as N,r as R,o as s,c as v,a as l,w as o,F as V,G as b,b as y,H as S,I as $,d as k,V as F,J as I,g as U,K as z,S as A,v as h,L as O,B as x,M as B,N as P,m as C,O as W,P as q,Q as G,x as J,R as D,T as K,i as Q,l as M,U as X,q as Y,t as Z,z as f,W as E}from"./index.284d2a1b.js";import{R as T}from"./Reader.58bdda0e.js";const ee={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}},te=U(" \u6CA1\u6709\u66F4\u591A\u4E86 ");function ae(t,i,n,a,w,m){const p=R("entry-card"),c=R("entry-card-skeleton"),r=R("c-dialog");return s(),v(V,null,[l(F,{dense:""},{default:o(()=>[(s(!0),v(V,null,b(n.data,e=>(s(),y($,S({key:e.id},t.$attrs),{default:o(()=>[l(p,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:H=>m.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),n.loading?(s(),v(V,{key:0},b(20,e=>l($,S({key:e},t.$attrs),{default:o(()=>[l(c)]),_:2},1040)),64)):k("",!0),!n.loading&&n.isLast?(s(),y($,{key:1,xl:"12",class:"text-align pa-3"},{default:o(()=>[te]),_:1})):k("",!0)]),_:1}),l(r,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e)),"max-width":"960","min-height":"calc(100vh - 48px)"},{default:o(()=>[I(t.$slots,"default")]),_:3},8,["model-value"])],64)}const le=N(ee,[["render",ae]]);const ne={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=z();return{mobile:t}},components:{Skeleton:A},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)}}},oe={class:"grid-2-between"},se={class:"grid-2"},ie=["onClick"],de={class:"text-ellipsis mr-3 title"},re={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ue={key:0,style:{"font-size":"0.75em"}},ce={class:"flex"},he={key:0,class:"text-center pa-3"};function me(t,i,n,a,w,m){const p=R("router-link"),c=R("skeleton"),r=R("c-dialog");return s(),v("div",null,[l(P,{variant:"text"},{default:o(()=>[(s(!0),v(V,null,b(n.data,e=>(s(),y(B,{key:e.id},{default:o(()=>[h("div",oe,[h("div",se,[m.isChannel?k("",!0):(s(),y(p,{key:0,style:O([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:o(()=>[U(x(e.channelName),1)]),_:2},1032,["style","to"])),h("div",{class:"grid-2 hover",onClick:H=>m.openRead(e.id)},[h("div",de,x(e.title),1),h("small",re,x(e.summary),1)],8,ie)]),a.mobile?k("",!0):(s(),v("small",ue,x(e.pubDate),1))])]),_:2},1024))),128)),n.loading?(s(),v(V,{key:0},b(20,e=>l(B,{key:e},{default:o(()=>[h("div",ce,[l(c,{height:"0.8em",width:"70%"}),l(c,{height:"0.8em",width:"50px"})])]),_:2},1024)),64)):k("",!0)]),_:1}),!n.loading&&n.isLast?(s(),v("div",he,"\u6CA1\u6709\u66F4\u591A\u4E86")):k("",!0),l(r,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e)),"max-width":"960","min-height":"calc(100vh - 48px)"},{default:o(()=>[I(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const _e=N(ne,[["render",me],["__scopeId","data-v-96e10f17"]]);function fe(t,i,n=()=>{}){i=i||t;let a=!0;const w=C(0),m=C(0),p=C(0),c=C(!1);return W(t,"scroll",r=>{if(w.value=i.scrollTop,m.value=i.scrollHeight,p.value=i.clientHeight,a){let e=i.scrollTop+i.clientHeight+120>i.scrollHeight;e&&n(),c.value=e,a=!1}setTimeout(()=>{c.value=!1,a=!0},300)}),{scrollTop:w,scrollHeight:m,clientHeight:p,isScrollBottom:c}}const pe={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=z();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){fe(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:A},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ge={ref:"channelRef"},ve=["onClick"],ye={style:{}},we=["textContent"],ke=["textContent"],xe={class:"flex"},Re=["textContent"],Ve={class:"item"},be={class:"flex"},Ce={key:1,class:"text-center pa-3"},$e={class:"box"};function Ie(t,i,n,a,w,m){const p=R("router-link"),c=R("skeleton");return s(),y(F,{dense:""},{default:o(()=>[q(l($,{xl:3,lg:4,md:6,sm:12},{default:o(()=>[l(J,null,{default:o(()=>[h("div",ge,[I(t.$slots,"channel",{},void 0,!0)],512),l(P,{ref:"listRef",variant:"text",class:"over-y",style:O({maxHeight:m.maxHeight})},{default:o(()=>[(s(!0),v(V,null,b(n.data,r=>(s(),y(B,{class:"py-2",key:r.id},{default:o(()=>[h("div",{class:"item hover",onClick:e=>m.openRead(r.id)},[l(D,{src:r.thumbnail?r.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),h("div",ye,[h("div",{textContent:x(r.title),style:{"font-size":"0.9em"}},null,8,we),h("small",{style:{display:"block"},textContent:x(r.summary)},null,8,ke),h("div",xe,[t.isChannel?k("",!0):(s(),y(p,{key:0,style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+r.channelId},{default:o(()=>[U(x(r.channelName),1)]),_:2},1032,["to"])),h("small",{textContent:x(r.pubDate)},null,8,Re)])])],8,ve)]),_:2},1024))),128)),n.loading?(s(),v(V,{key:0},b(20,r=>l(B,{class:"py-2",key:r},{default:o(()=>[h("div",Ve,[l(D,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),h("div",null,[l(c,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(c,{height:"0.7em",width:"calc(1oo% - 100px)"}),h("div",be,[l(c,{height:"0.6em",width:"100px"}),l(c,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):k("",!0),!n.loading&&n.isLast?(s(),v("div",Ce,"\u6CA1\u6709\u66F4\u591A\u4E86")):k("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[G,!(a.mobile&&n.showReader)]]),l(K,{name:"list"},{default:o(()=>[n.showReader?(s(),y($,{key:0,xl:9,lg:8,md:6,sm:12},{default:o(()=>[h("div",$e,[I(t.$slots,"default",{},void 0,!0)])]),_:3})):k("",!0)]),_:3})]),_:3})}const Be=N(pe,[["render",Ie],["__scopeId","data-v-a03e3d8c"]]),Me={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const i=t,n=Q("currentViewName"),a=C({}),w=i.loadMore,m=M(()=>i.data),p=M(()=>i.loading),c=M(()=>i.isLast),r=X();Y(a,u=>{u.id&&(r.pushHash("/article/"+u.id),document.title=(u.title||"")+" | WebFollow")});async function e(u){a.value=await E(u),a.value.id=u}const H=u=>{let d=a.value.id,_=u.length;for(let g=0;g<_;g++)if(u[g].id==d&&g>0)return u[g-1].id;return null};function j(u){let d=a.value.id,_=u.length;for(let g=0;g<_;g++){let L=u[g];if(L.id==d&&g+3>_&&w(),L.id==d&&g+1<_)return u[g+1].id}return null}return Z(async u=>{let d;u.detail=="up"?d=H(m.value):u.detail=="down"&&(d=j(m.value)),d&&e(d)}),(u,d)=>f(n)=="cards-view"?(s(),y(le,{key:0,loadMore:f(w),data:f(m),loading:f(p),"is-last":f(c),"show-reader":a.value.id,"onUpdate:show-reader":d[1]||(d[1]=_=>a.value.id=_),onClickItemRead:e},{default:o(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=_=>a.value=_)},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):f(n)=="title-only-view"?(s(),y(_e,{key:1,loadMore:f(w),data:f(m),loading:f(p),"is-last":f(c),"show-reader":a.value.id,"onUpdate:show-reader":d[3]||(d[3]=_=>a.value.id=_),onClickItemRead:e},{default:o(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":d[2]||(d[2]=_=>a.value=_)},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(s(),y(Be,{key:2,loadMore:f(w),data:f(m),loading:f(p),"show-reader":a.value.id,"is-last":f(c),onClickItemRead:e},{default:o(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":d[4]||(d[4]=_=>a.value=_),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))}};export{Me as _,fe as u};
