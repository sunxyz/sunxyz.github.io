import{h as x,j as B,_ as D,s as E,k as F,l as g,m as T,n as I,p as R,q as Y,t as q,r as A,o as c,c as d,a as s,w as u,v as r,x as H,y as U,z as o,A as v,d as $,B as j,C as p,D as G,g as V,E as Q,G as W,F as J}from"./index.38308ce9.js";import{V as K}from"./VSnackbar.91c21feb.js";function O(t){return x.post("/star",null,{params:{itemId:t}})}function P(t){return x.delete("/star",{params:{itemId:t}})}function he(t){return x.get("/star/articles",{params:t})}function X(t){return x.get("/proxy/html-text",{params:t})}async function Z(t,n){return n=="text"?await ee(t):n=="html"?await L(t):await L(t)}async function L(t){return(location.hostname.includes("localhost")?"http://localhost:8080/api":"https://api.webfollow.cc/api")+"/proxy/html-text?url="+t}async function ee(t){let n=await X({url:t});return te(n).content}function te(t){var n=document.implementation.createHTMLDocument("doc");n.documentElement.innerHTML=t;var m=new B.Readability(n.cloneNode(!0)).parse();return m}const ae={class:"ctrl-item",title:"\u52A0\u8F7D\u7F51\u9875\u6587\u672C-\u9605\u8BFB\u6A21\u5F0F \u5FEB\u6377\u952E(ctrl+alt+r)"},le={class:"ctrl-item",title:"\u5185\u5D4C\u7F51\u9875 \u5FEB\u6377\u952E(ctrl+alt+i)"},oe={key:0,class:"ctrl-item",title:"\u6536\u85CF \u5FEB\u6377\u952E(ctrl+alt+s)"},se={class:"ctrl-item",title:"\u5173\u95ED \u5FEB\u6377\u952E(ctrl+alt+q)"},ne={key:0,class:"read"},ie=["src"],re={key:1,class:"normalize read"},ce={class:"mr-3 mt-3"},de=["href"],ue=["textContent"],me={class:"mx-auto"},fe={__name:"Reader",props:["modelValue","overY","ctrlStyle"],emits:["update:modelValue"],setup(t,{emit:n}){const m=t,{token:M}=E(F()),a=g(()=>m.modelValue),N=g(()=>m.overY),z=g(()=>m.ctrlStyle||{}),y=T(!1),i=T(void 0),f=I({show:!1,msg:void 0}),_=e=>n("update:modelValue",e);R(()=>{let e=T();Y(a,l=>{e&&l.id&&(e.scrollTop=0),i.value&&b(i.value)})});async function C(){let e=a.value;try{e.star?await P(e.id):await O(e.id),e.star=!e.star,_(e)}catch{f.msg="\u51FA\u73B0\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",f.show=!0}}async function h(e){if(e==i.value){let l=a.value;i.value=void 0,l.descriptionText=void 0,_(l);return}await b(e)}async function b(e){let l=a.value;y.value=!0;let k=await Z(l.link,e);i.value=e,l.descriptionText=k,_(l),y.value=!1}function S(){_({})}return R(()=>{q(async e=>{e.detail=="rendText"?h("text"):e.detail=="rendHtml"?h("html"):e.detail=="readerQuit"?S():e.detail=="readerStar"&&C()})}),(e,l)=>{const k=A("router-link");return c(),d(J,null,[s(H,{loading:y.value},{default:u(()=>[r("div",{class:W(["read-box",{"over-y":o(N)}])},[s(H,{class:"ctrl",style:U(o(z)),width:"50px"},{default:u(()=>[r("div",ae,[s(v,{icon:"mdi:mdi-book-open",color:i.value=="text"?"indigo":"",onClick:l[0]||(l[0]=w=>h("text"))},null,8,["color"])]),r("div",le,[s(v,{icon:"mdi:mdi-google-chrome",color:i.value=="html"?"indigo":"",onClick:l[1]||(l[1]=w=>h("html"))},null,8,["color"])]),o(M)?(c(),d("div",oe,[s(v,{icon:"mdi:mdi-star"+(o(a).star?"":"-outline"),variant:"outlined",color:o(a).star?"indigo":"",onClick:C},null,8,["icon","color"])])):$("",!0),r("div",se,[s(v,{icon:"mdi:mdi-close",onClick:S})])]),_:1},8,["style"]),i.value=="html"?(c(),d("div",ne,[r("iframe",{src:o(a).descriptionText,frameborder:"0",class:"read-box",width:"100%"},null,8,ie)])):(c(),d("div",re,[r("div",null,[r("div",ce,[s(j,{class:"text-ellipsis",style:{"max-width":"90%","font-size":"2em"}},{default:u(()=>[o(a).link?(c(),d("a",{key:0,target:"_blank",href:o(a).link},p(o(a).title),9,de)):(c(),d("span",{key:1,textContent:p(o(a).title)},null,8,ue))]),_:1})]),s(G,{class:"mb-2 mt-1"},{default:u(()=>[s(k,{to:"/channel/"+o(a).channelId},{default:u(()=>[V(p(o(a).channelName),1)]),_:1},8,["to"]),V(" "+p(o(a).pubDateTime),1)]),_:1})]),r("div",me,[s(Q,{innerHTML:o(a).descriptionText||o(a).description,class:"read-warp"},null,8,["innerHTML"])])]))],2)]),_:1},8,["loading"]),s(K,{location:"top",timeout:2e3,modelValue:f.show,"onUpdate:modelValue":l[2]||(l[2]=w=>f.show=w)},{default:u(()=>[V(p(f.msg),1)]),_:1},8,["modelValue"])],64)}}},ve=D(fe,[["__scopeId","data-v-36d89e9e"]]);export{ve as R,he as f};
