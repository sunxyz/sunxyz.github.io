import{_ as u,u as h,i as o,a as c,f,r as p,o as s,c as w,b as g,d as r,w as d,V as _,e as l,F as N,g as x,h as y,t as $}from"./index.d851babc.js";import{f as B}from"./Reader.2d5362c8.js";import{_ as L,u as M}from"./IndexView.44b297ea.js";import"./VSnackbar.bf87abd4.js";const{setBar:D}=h(),V={data:()=>({data:[],params:{source:void 0,folder:void 0,page:0,size:20},isLast:!0,loading:!0}),components:{IndexView:L},setup(){const t=o("currentViewName"),a=o("sortName"),{t:i}=c();return{viewName:t,sortName:a,t:i}},mounted(){M(window,document.documentElement,()=>{this.loadMore()}),this.initData()},computed:{hideLoadMoreBtn(){return this.viewName=="column-view"}},methods:{async initData(){let t=this.t("layout.home"),a="mdi:mdi-home";this.$route.fullPath=="/"?(this.params.source="HOME",this.params.source=void 0,this.params.folder=void 0):this.$route.fullPath=="/explore"?(this.params.source="EXPLORE",t=this.t("layout.explore"),a="mdi:mdi-compass"):this.$route.path.indexOf("/folder")==0?(this.params.source="HOME",t=this.$route.params.id,this.params.folder=t,t=t=="root"?"\u8BA2\u9605\u6E90":t,a="mdi:mdi-folder-outline"):this.$route.fullPath=="/star"&&(t=this.t("layout.star"),a="mdi:mdi-star"),this.params.sort=void 0,this.sortName&&this.$route.fullPath!="/star"&&(this.params.sort=this.sortName+",desc"),D(t,a),this.params.page=0,this.data=await this.loadData()},async loadData(){this.loading=!0;let t=this.$route.fullPath.includes("star")?await B(this.params):await f(this.params);return this.loading=!1,this.isLast=t.last,t.content},async loadMore(){this.isLast||(this.params.page+=1,this.data=[...this.data,...await this.loadData()])}},watch:{$route(t){this.params.folder==t.query.name&&t.path=="/folder"||(this.data=[],this.loading=!0,this.initData())},sortName(){this.data=[],this.loading=!0,this.initData()}}};function k(t,a,i,n,E,e){const m=p("index-view");return s(),w(N,null,[g(m,{data:t.data,"load-more":e.loadMore,loading:t.loading,"is-last":t.isLast,xl:3,lg:3,md:4,sm:6,xs:12},null,8,["data","load-more","loading","is-last"]),e.hideLoadMoreBtn?l("",!0):(s(),r(_,{key:0,class:"ma-3"},{default:d(()=>[t.isLast?l("",!0):(s(),r(x,{key:0,class:"mx-auto",onClick:e.loadMore},{default:d(()=>[y($(n.t("loadMoreBtn")),1)]),_:1},8,["onClick"]))]),_:1}))],64)}const A=u(V,[["render",k]]);export{A as default};
