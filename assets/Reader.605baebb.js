import{h as y,j as Y,_ as $,s as q,k as A,l as U,m as g,n as h,p as j,q as N,t as G,v as Q,r as J,o as d,c as u,a as s,w as m,x as i,y as z,z as D,A as o,B as K,C as x,d as O,D as P,E as p,G as W,g as V,H as X,F as Z}from"./index.06059866.js";import{V as ee}from"./VSnackbar.90f1bd72.js";function te(t){return y.post("/star",null,{params:{itemId:t}})}function ae(t){return y.delete("/star",{params:{itemId:t}})}function Te(t){return y.get("/star/articles",{params:t})}function le(t){return y.get("/proxy/html-text",{params:t})}async function oe(t,n){return n=="text"?await se(t):n=="html"?await B(t):await B(t)}async function B(t){return(location.hostname.includes("localhost")?"http://localhost:8080/api":"https://api.webfollow.cc/api")+"/proxy/html-text?url="+t}async function se(t){let n=await le({url:t});return ne(n).content}function ne(t){var n=document.implementation.createHTMLDocument("doc");n.documentElement.innerHTML=t;var f=new Y.Readability(n.cloneNode(!0)).parse();return f}const ie={class:"read"},re={class:"ctrl-item",title:"\u52A0\u8F7D\u7F51\u9875\u6587\u672C-\u9605\u8BFB\u6A21\u5F0F \u5FEB\u6377\u952E(r)"},ce={class:"ctrl-item",title:"\u5185\u5D4C\u7F51\u9875 \u5FEB\u6377\u952E(e)"},de={key:0,class:"ctrl-item",title:"\u6536\u85CF \u5FEB\u6377\u952E(ctrl+alt+s)"},ue={class:"ctrl-item",title:"\u5173\u95ED \u5FEB\u6377\u952E(q)"},me={key:0,class:""},fe=["src"],pe={key:1,class:"normalize"},_e={class:"mr-3 mt-3"},ve=["href"],he=["textContent"],xe={class:"mx-auto"},ye={__name:"Reader",props:["modelValue","overY","ctrlStyle"],emits:["update:modelValue"],setup(t,{emit:n}){const f=t,{token:E}=q(A()),{mobile:F}=U(),a=g(()=>f.modelValue),C=g(()=>f.overY),I=g(()=>f.ctrlStyle||{}),k=h(!1),r=h(void 0),c=j({show:!1,msg:void 0}),_=e=>n("update:modelValue",e),S=h(),H=h();function w(){return C.value?H.value:S.value.$el}N(()=>{G(a,e=>{e.id&&(w().scrollTop=0),r.value&&L(r.value)})});async function R(){let e=a.value;try{e.star?await ae(e.id):await te(e.id),e.star=!e.star,_(e)}catch{c.msg="\u51FA\u73B0\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",c.show=!0}}async function v(e){if(e==r.value){let l=a.value;r.value=void 0,l.descriptionText=void 0,_(l);return}await L(e)}async function L(e){let l=a.value;k.value=!0;try{let T=await oe(l.link,e);r.value=e,l.descriptionText=T,_(l)}catch{c.msg="\u51FA\u73B0\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",c.show=!0}k.value=!1}function M(){_({})}return N(()=>{Q(async e=>{if(e.detail=="rendText")v("text");else if(e.detail=="rendHtml")v("html");else if(e.detail=="readerQuit")M();else if(e.detail=="readerStar")R();else if(e.detail=="top")w().scrollTop-=50;else if(e.detail=="bottom")w().scrollTop+=50;else if(e.detail=="openTarget"){let l=window.open("about:blank");l.location.href=a.value.link}})}),(e,l)=>{const T=J("router-link");return d(),u(Z,null,[s(z,{ref_key:"reader0",ref:S,loading:k.value},{default:m(()=>[i("div",{ref_key:"reader1",ref:H,class:D(["read-box",{"over-y":o(C)}]),tabindex:"0"},[i("div",ie,[s(z,{class:D(["ctrl side",{"ctrl-mobile":o(F)}]),style:K(o(I))},{default:m(()=>[i("div",re,[s(x,{icon:"mdi:mdi-book-open",color:r.value=="text"?"primary":"",onClick:l[0]||(l[0]=b=>v("text"))},null,8,["color"])]),i("div",ce,[s(x,{icon:"mdi:mdi-google-chrome",color:r.value=="html"?"primary":"",onClick:l[1]||(l[1]=b=>v("html"))},null,8,["color"])]),o(E)?(d(),u("div",de,[s(x,{icon:"mdi:mdi-star"+(o(a).star?"":"-outline"),variant:"outlined",color:o(a).star?"primary":"",onClick:R},null,8,["icon","color"])])):O("",!0),i("div",ue,[s(x,{icon:"mdi:mdi-close",onClick:M})])]),_:1},8,["class","style"]),r.value=="html"?(d(),u("div",me,[i("iframe",{src:o(a).descriptionText,frameborder:"0",class:"read-box",width:"100%"},null,8,fe)])):(d(),u("div",pe,[i("div",null,[i("div",_e,[s(P,{class:"text-ellipsis",style:{"max-width":"90%","font-size":"2em"}},{default:m(()=>[o(a).link?(d(),u("a",{key:0,target:"_blank",href:o(a).link},p(o(a).title),9,ve)):(d(),u("span",{key:1,textContent:p(o(a).title)},null,8,he))]),_:1})]),s(W,{class:"mb-2 mt-1"},{default:m(()=>[s(T,{to:"/channel/"+o(a).channelId},{default:m(()=>[V(p(o(a).channelName),1)]),_:1},8,["to"]),V(" "+p(o(a).pubDateTime),1)]),_:1})]),i("div",xe,[s(X,{innerHTML:o(a).descriptionText||o(a).description,class:"read-warp"},null,8,["innerHTML"])])]))])],2)]),_:1},8,["loading"]),s(ee,{location:"top",timeout:2e3,modelValue:c.show,"onUpdate:modelValue":l[2]||(l[2]=b=>c.show=b)},{default:m(()=>[V(p(c.msg),1)]),_:1},8,["modelValue"])],64)}}},be=$(ye,[["__scopeId","data-v-4f82104b"]]);export{be as R,Te as f};
