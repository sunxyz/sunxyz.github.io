import{_ as U,r as R,o,c as v,d as l,w as r,F as C,N as $,e as k,O as N,P as B,g as w,V as A,t as g,Q as I,q as F,S as O,C as f,H as z,j as P,R as H,T as j,x as V,U as G,W as Q,X,D as Y,Y as D,Z,i as J,v as L,p as K,A as S,B as E,G as p,$ as ee}from"./index.5f190924.js";import{R as T}from"./Reader.e06f9e1c.js";const te={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}},ae={key:0,class:"text-align pa-3"};function le(t,i,n,a,b,c){const _=R("entry-card"),h=R("entry-card-skeleton"),s=R("c-dialog");return o(),v(C,null,[l(A,{dense:""},{default:r(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),k(B,N({key:e.id},t.$attrs),{default:r(()=>[l(_,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:x=>c.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(B,N({key:e},t.$attrs),{default:r(()=>[l(h)]),_:2},1040)),64)):w("",!0)]),_:1}),!n.loading&&n.isLast?(o(),v("div",ae,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0),l(s,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:r(()=>[I(t.$slots,"default")]),_:3},8,["model-value"])],64)}const ne=U(te,[["render",le]]);const oe={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=F();return{mobile:t}},components:{Skeleton:O},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)},log(t){console.log(t),this.openRead(t.id)}}},se={class:"grid-2-between"},ie={class:"grid-2"},de=["onClick"],re={class:"text-ellipsis mr-3 title"},ue={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ce={key:0,style:{"font-size":"0.75em"}},he={class:"flex"},fe={key:0,class:"text-center pa-3"};function me(t,i,n,a,b,c){const _=R("router-link"),h=R("skeleton"),s=R("c-dialog");return o(),v("div",null,[l(j,{density:"compact"},{default:r(()=>[(o(!0),v(C,null,$(n.data,e=>(o(),k(H,{key:e.id,value:e.id,onClick:x=>c.openRead(e.id)},{default:r(()=>[f("div",se,[f("div",ie,[c.isChannel?w("",!0):(o(),k(_,{key:0,tabindex:"-1",style:z([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:r(()=>[P(g(e.channelName),1)]),_:2},1032,["style","to"])),f("div",{class:"grid-2 hover",onClick:x=>c.openRead(e.id)},[f("div",re,g(e.title),1),f("small",ue,g(e.summary),1)],8,de)]),a.mobile?w("",!0):(o(),v("small",ce,g(e.pubDate),1))])]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,e=>l(H,{key:e,value:e},{default:r(()=>[f("div",he,[l(h,{height:"0.8em",width:"70%"}),l(h,{height:"0.8em",width:"50px"})])]),_:2},1032,["value"])),64)):w("",!0)]),_:1}),!n.loading&&n.isLast?(o(),v("div",fe,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0),l(s,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:r(()=>[I(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const _e=U(oe,[["render",me],["__scopeId","data-v-33d83b0b"]]);function pe(t,i,n=()=>{}){i=i||t;let a=!0;const b=V(0),c=V(0),_=V(0),h=V(!1);return G(t,"scroll",s=>{if(b.value=i.scrollTop,c.value=i.scrollHeight,_.value=i.clientHeight,a){let e=i.scrollTop+i.clientHeight+120>i.scrollHeight;e&&n(),h.value=e,a=!1}setTimeout(()=>{h.value=!1,a=!0},300)}),{scrollTop:b,scrollHeight:c,clientHeight:_,isScrollBottom:h}}const ve={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=F();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){pe(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:O},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"},isChannel(){return this.$route.fullPath.indexOf("channel")>0}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ye={ref:"channelRef"},ge=["onClick"],ke={style:{}},we=["textContent"],xe=["textContent"],Re={class:"flex"},be={key:1},Ce=["textContent"],Ve={class:"item"},$e={class:"flex"},Be={key:1,class:"text-center pa-3"},Ie={class:"box"};function He(t,i,n,a,b,c){const _=R("router-link"),h=R("skeleton");return o(),k(A,{dense:""},{default:r(()=>[Q(l(B,{xl:3,lg:4,md:6,sm:12},{default:r(()=>[l(Y,null,{default:r(()=>[f("div",ye,[I(t.$slots,"channel",{},void 0,!0)],512),l(j,{"select-strategy":"independent",ref:"listRef",variant:"text",class:"over-y",style:z({maxHeight:c.maxHeight}),density:"compact"},{default:r(()=>[(o(!0),v(C,null,$(n.data,s=>(o(),k(H,{class:"py-2",key:s.id,value:"article/"+s.id,onClick:e=>c.openRead(s.id)},{default:r(()=>[f("div",{class:"item",onClick:e=>c.openRead(s.id)},[l(D,{src:s.thumbnail?s.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),f("div",ke,[f("div",{textContent:g(s.title),style:{"font-size":"0.9em"}},null,8,we),f("small",{style:{display:"block"},textContent:g(s.summary)},null,8,xe),f("div",Re,[c.isChannel?(o(),v("span",be)):(o(),k(_,{key:0,tabindex:"-1",style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+s.channelId},{default:r(()=>[P(g(s.channelName),1)]),_:2},1032,["to"])),f("small",{textContent:g(s.pubDate)},null,8,Ce)])])],8,ge)]),_:2},1032,["value","onClick"]))),128)),n.loading?(o(),v(C,{key:0},$(20,s=>l(H,{class:"py-2",key:s},{default:r(()=>[f("div",Ve,[l(D,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),f("div",null,[l(h,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(h,{height:"0.7em",width:"calc(1oo% - 100px)"}),f("div",$e,[l(h,{height:"0.6em",width:"100px"}),l(h,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):w("",!0),!n.loading&&n.isLast?(o(),v("div",Be,g(t.$vuetify.locale.t("notMoreBtn")),1)):w("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[X,!(a.mobile&&n.showReader)]]),l(Z,{name:"list"},{default:r(()=>[n.showReader?(o(),k(B,{key:0,xl:9,lg:8,md:6,sm:12},{default:r(()=>[f("div",Ie,[I(t.$slots,"default",{},void 0,!0)])]),_:3})):w("",!0)]),_:3})]),_:3})}const Me=U(ve,[["render",He],["__scopeId","data-v-7742abe2"]]),Ne={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const i=t,n=J("currentViewName"),a=V({}),b=V(void 0),c=i.loadMore,_=L(()=>i.data),h=L(()=>i.loading),s=L(()=>i.isLast),e=K();S(a,d=>{d.id&&(e.pushHash("/article/"+d.id),document.title=(d.title||"")+" | WebFollow")}),S(b,d=>{x(d)});async function x(d){a.value=await ee(d),a.value.id=d}const W=d=>{let u=a.value.id,m=d.length;for(let y=0;y<m;y++)if(d[y].id==u&&y>0)return d[y-1].id;return null};function q(d){let u=a.value.id,m=d.length;for(let y=0;y<m;y++){let M=d[y];if(M.id==u&&y+3>m&&c(),M.id==u&&y+1<m)return d[y+1].id}return null}return E(async d=>{let u;d.detail=="up"?u=W(_.value):d.detail=="down"&&(u=q(_.value)),u&&x(u)}),(d,u)=>p(n)=="cards-view"?(o(),k(ne,N({key:0,loadMore:p(c),data:p(_),loading:p(h)},d.$attrs,{"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":u[1]||(u[1]=m=>a.value.id=m),onClickItemRead:x}),{default:r(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},16,["loadMore","data","loading","is-last","show-reader"])):p(n)=="title-only-view"?(o(),k(_e,{key:1,loadMore:p(c),data:p(_),loading:p(h),"is-last":p(s),"show-reader":a.value.id,"onUpdate:show-reader":u[3]||(u[3]=m=>a.value.id=m),onClickItemRead:x},{default:r(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=m=>a.value=m),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(o(),k(Me,{key:2,loadMore:p(c),data:p(_),loading:p(h),"show-reader":a.value.id,"is-last":p(s),onClickItemRead:x},{default:r(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=m=>a.value=m),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))}};export{Ne as _,pe as u};
