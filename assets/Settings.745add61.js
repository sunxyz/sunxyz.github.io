import{_ as F,u as E,s as I,a as R,aR as q,p as H,b as J,S as K,r as w,o as r,c as u,d as t,w as s,V as W,F as h,N as k,C as S,Q as A,bs as M,j as d,t as o,L as y,aW as z,P as T,X as j,e as c,I as G,H as L,B as m,J as f,h as V,K as p,bt as O,bu as v,bv as P,g as N,bw as Q,T as C,bx as B,D as U}from"./index.0c4a6453.js";import{g as X,c as Y,u as Z,V as $,a as ee}from"./VTable.c5a93be2.js";import{V as te}from"./VSnackbar.f56eed8e.js";import{b as se}from"./VTextField.7768c314.js";const{setBar:le}=E(),ie={data(){return{items:[{text:"\u8BA2\u9605\u8BBE\u7F6E",icon:"mdi:mdi-rss"},{text:"\u63A8\u9001\u8BBE\u7F6E",icon:"mdi:mdi-send"},{text:"\u5FEB\u6377\u952E0",icon:"mdi:mdi-keyboard-settings"}],item:{},slider:{min:0,max:20},tip:{show:!1,msg:void 0},loading:!1,btnLoading:!1,settings:{itemsLimit:0,itemsTheme:0,email:"",follows:[]}}},setup(){const{token:a}=I(R()),{reloadFollow:n}=q(),{mobile:b}=H(),{t:l}=J();function i(g){return l("settings."+g)}return{mobile:b,token:a,reloadFollow:n,st:i,t:l}},components:{Skeleton:K},methods:{async initData(){this.loading=!0,await this.loadData(),this.loading=!1},async loadData(){let a=await X();a.follows.forEach(n=>{n.sort_copy=n.sort,n.folderName_copy=n.folderName}),this.settings=a},async save(a){this.btnLoading=!0,a=="rss"?await this.changeFollows():await this.update(),this.btnLoading=!1},async changeFollows(){try{let a=this.settings.follows.filter(n=>n.sort_copy!=n.sort||n.folderName_copy!=n.folderName);a.length&&(await Y(a),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData(),this.reloadFollow())}catch(a){console.log(a),this.tip.show=!0,this.tip.msg=this.t("errorTip")}},async update(){try{let a={itemsLimit:this.settings.itemsLimit,itemsTheme:this.settings.itemsTheme,enabledNewsletterSend:this.settings.enabledNewsletterSend};await Z(a),this.tip.show=!0,this.tip.msg=this.t("successTip"),this.loadData()}catch{this.tip.show=!0,this.tip.msg=this.t("errorTip")}},show(a){this.item=a}},mounted(){le(this.st("appbar"),"mdi:mdi-cog-outline"),this.token&&this.initData(),this.items=[{id:"newsletter",text:"pushSeting",icon:"mdi:mdi-email"},{id:"rss",text:"rssSeting",icon:"mdi:mdi-rss"},{id:"keyborad",text:"quickKeyboard",icon:"mdi:mdi-keyboard-settings"}],this.item=this.items[0]}},ne={class:"flex pr-4"},ae=["textContent"],oe=["href"],re=["onUpdate:modelValue"],de=["onUpdate:modelValue"],me={key:1,class:"my-6 mx-auto text-center"},ue=d(" 7:00-12:00 "),ce=["innerHTML"];function he(a,n,b,l,i,g){const D=w("router-link"),x=w("skeleton");return r(),u(h,null,[t(W,{dense:""},{default:s(()=>[t(k,{xl:3,lg:4,md:6,sm:12,cols:12},{default:s(()=>[t(S,{class:"text"},{default:s(()=>[t(A,null,{default:s(()=>[t(M,null,{default:s(()=>[d(o(l.st("title")),1)]),_:1}),(r(!0),u(h,null,y(i.items,(e,_)=>(r(),c(T,{key:_,value:l.st(e.text),onClick:fe=>g.show(e)},{prepend:s(()=>[t(L,{icon:e.icon},null,8,["icon"])]),default:s(()=>[t(Q,{textContent:o(l.st(e.text))},null,8,["textContent"])]),_:2},1032,["value","onClick"]))),128)),t(z),t(T,{"prepend-icon":"far fa-circle-question",title:l.st("feedback"),target:"_blank",href:"https://docs.qq.com/sheet/DSFhscEJ0cEFKWW9W?tab=BB08J2"},null,8,["title"])]),_:1})]),_:1})]),_:1}),t(j,{name:"list"},{default:s(()=>[i.item.text?(r(),c(k,{key:0,xl:9,lg:8,md:6,sm:12,cols:12},{default:s(()=>[t(S,{class:"py-3"},{default:s(()=>[t(G,{class:"mb-3"},{default:s(()=>[t(L,{icon:i.item.icon,class:"mr-3"},null,8,["icon"]),d(" "+o(l.st(i.item.text)),1)]),_:1}),i.item.id=="rss"?(r(),u(h,{key:0},[m("div",ne,[t(f,null,{default:s(()=>[d(o(l.st("rssSubTitle")),1)]),_:1}),t(V,{color:"primary",to:"/setup",variant:"outlined",title:l.st("rssAddBtn"),size:"small","prepend-icon":"fas fa-plus"},{default:s(()=>[d(o(l.st("rssAddBtn")),1)]),_:1},8,["title"])]),t(p,null,{default:s(()=>[i.settings.follows.length?(r(),c($,{key:0,"fixed-header":"",height:"calc(100vh - 280px)"},{default:s(()=>[m("thead",null,[m("tr",null,[(r(!0),u(h,null,y(JSON.parse(decodeURI(l.st("rssTableCols"))),e=>(r(),u("th",{class:"text-left",key:e,textContent:o(e)},null,8,ae))),128))])]),m("tbody",null,[(r(!0),u(h,null,y(i.settings.follows,e=>(r(),u("tr",{key:e.name},[m("td",null,o(e.channelName),1),m("td",null,[m("a",{target:"_blank",href:e.rssUrl,title:"\u67E5\u770Brss"},o(e.rssUrl),9,oe)]),m("td",null,[C(m("input",{type:"text","onUpdate:modelValue":_=>e.sort=_,class:U(["item-sort",{"item-change":e.sort!=e.sort_copy}])},null,10,re),[[B,e.sort]])]),m("td",null,[C(m("input",{type:"text","onUpdate:modelValue":_=>e.folderName=_,class:U(["item-sort",{"item-change":e.folderName!=e.folderName_copy}])},null,10,de),[[B,e.folderName]])])]))),128))])]),_:1})):(r(),u("div",me,[t(D,{to:"/setup"},{default:s(()=>[d(o(l.st("rssEmptyTip")),1)]),_:1})]))]),_:1}),i.loading?(r(),c(x,{key:1,class:"ma-3",width:"64px",height:"36px"})):(r(),c(V,{key:0,loading:i.btnLoading,class:"ma-3",color:"primary",onClick:n[0]||(n[0]=()=>l.token?g.save("rss"):a.$router.push("/login")),disabled:l.token?i.settings.follows.filter(e=>e.sort_copy!=e.sort||e.folderName_copy!=e.folderName).length==0:!1},{default:s(()=>[d(o(l.token?l.st("comfirmBtn"):l.st("noLoginBtn")),1)]),_:1},8,["loading","disabled"]))],64)):i.item.id=="newsletter"?(r(),u(h,{key:1},[t(f,null,{default:s(()=>[d(o(l.st("pushEmail")),1)]),_:1}),t(p,{class:"px-6"},{default:s(()=>[d(o(i.settings.email),1)]),_:1}),t(f,null,{default:s(()=>[d(o(l.st("pushTime")),1)]),_:1}),t(p,{class:"px-6"},{default:s(()=>[ue]),_:1}),t(f,null,{default:s(()=>[d(o(l.st("pushView")),1)]),_:1}),t(p,null,{default:s(()=>[t(O,{modelValue:i.settings.itemsTheme,"onUpdate:modelValue":n[1]||(n[1]=e=>i.settings.itemsTheme=e)},{default:s(()=>[t(v,{label:l.st("pushViewSimple"),value:0},null,8,["label"]),t(v,{label:l.st("pushViewDetails"),value:1},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:s(()=>[d(o(l.st("pushLimit")),1)]),_:1}),t(p,null,{default:s(()=>[t(P,{modelValue:i.settings.itemsLimit,"onUpdate:modelValue":n[3]||(n[3]=e=>i.settings.itemsLimit=e),class:"align-center",max:i.slider.max,min:i.slider.min,step:1,"hide-details":""},{append:s(()=>[t(se,{modelValue:i.settings.itemsLimit,"onUpdate:modelValue":n[2]||(n[2]=e=>i.settings.itemsLimit=e),"hide-details":"","single-line":"",density:"compact",type:"number",style:{width:"70px"}},null,8,["modelValue"])]),_:1},8,["modelValue","max","min"])]),_:1}),t(f,null,{default:s(()=>[d(o(l.st("pushEnabled")),1)]),_:1}),t(p,{class:"px-6"},{default:s(()=>[t(ee,{modelValue:i.settings.enabledNewsletterSend,"onUpdate:modelValue":n[4]||(n[4]=e=>i.settings.enabledNewsletterSend=e),"hide-details":"",inset:""},null,8,["modelValue"])]),_:1}),i.loading?(r(),c(x,{key:1,class:"ma-3",width:"64px",height:"36px"})):(r(),c(V,{key:0,loading:i.btnLoading,class:"ma-3",color:"primary",onClick:n[5]||(n[5]=()=>l.token?g.save():a.$router.push("/login"))},{default:s(()=>[d(o(l.token?l.st("comfirmBtn"):l.st("noLoginBtn")),1)]),_:1},8,["loading"]))],64)):i.item.id=="keyborad"?(r(),u("div",{key:2,class:"pa-3 text-h",innerHTML:l.st("quickKeyboardHtml")},null,8,ce)):N("",!0)]),_:1})]),_:1})):N("",!0)]),_:1})]),_:1}),t(te,{location:"top",timeout:5e3,modelValue:i.tip.show,"onUpdate:modelValue":n[6]||(n[6]=e=>i.tip.show=e)},{default:s(()=>[d(o(i.tip.msg),1)]),_:1},8,["modelValue"])],64)}const Ve=F(ie,[["render",he],["__scopeId","data-v-a44bafaa"]]);export{Ve as default};
