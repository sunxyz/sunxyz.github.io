import{_ as N,r as x,o,c as v,a as l,w as s,F as b,H as $,b as g,I as S,J as I,d as w,V as z,K as B,g as U,L as A,S as O,v as h,y as P,C as k,M as H,N as j,m as C,O as J,P as K,Q,x as G,R as D,T as X,i as Y,l as M,U as Z,q as F,t as E,z as p,W as ee}from"./index.38308ce9.js";import{R as T}from"./Reader.9a1115d9.js";const te={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],methods:{openRead(t){this.$emit("click-item-read",t)}}},ae=U(" \u6CA1\u6709\u66F4\u591A\u4E86 ");function le(t,i,n,a,R,_){const m=x("entry-card"),c=x("entry-card-skeleton"),d=x("c-dialog");return o(),v(b,null,[l(z,{dense:""},{default:s(()=>[(o(!0),v(b,null,$(n.data,e=>(o(),g(I,S({key:e.id},t.$attrs),{default:s(()=>[l(m,{"img-src":e.thumbnail,"channel-icon":e.channelIcon,title:e.title,"channel-name":e.channelName,"pub-date":e.pubDate,"channel-id":e.channelId,onClick:V=>_.openRead(e.id)},null,8,["img-src","channel-icon","title","channel-name","pub-date","channel-id","onClick"])]),_:2},1040))),128)),n.loading?(o(),v(b,{key:0},$(20,e=>l(I,S({key:e},t.$attrs),{default:s(()=>[l(c)]),_:2},1040)),64)):w("",!0),!n.loading&&n.isLast?(o(),g(I,{key:1,xl:"12",class:"text-align pa-3"},{default:s(()=>[ae]),_:1})):w("",!0)]),_:1}),l(d,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:s(()=>[B(t.$slots,"default")]),_:3},8,["model-value"])],64)}const ne=N(te,[["render",le]]);const se={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read","update:showReader"],setup(){const{mobile:t}=A();return{mobile:t}},components:{Skeleton:O},computed:{isChannel(){return this.$route.fullPath.indexOf("channel")>0}},methods:{openRead(t){this.$emit("click-item-read",t)}}},oe={class:"grid-2-between"},ie={class:"grid-2"},de=["onClick"],re={class:"text-ellipsis mr-3 title"},ue={style:{"max-width":"600px",display:"inline-block"},class:"text-ellipsis"},ce={key:0,style:{"font-size":"0.75em"}},he={class:"flex"},_e={key:0,class:"text-center pa-3"};function fe(t,i,n,a,R,_){const m=x("router-link"),c=x("skeleton"),d=x("c-dialog");return o(),v("div",null,[l(j,{variant:"text"},{default:s(()=>[(o(!0),v(b,null,$(n.data,e=>(o(),g(H,{key:e.id,value:"article/"+e.id},{default:s(()=>[h("div",oe,[h("div",ie,[_.isChannel?w("",!0):(o(),g(m,{key:0,style:P([{display:"inline-block","font-size":"0.75em"},{width:a.mobile?"80px":"150px"}]),class:"text-ellipsis",to:"/channel/"+e.channelId},{default:s(()=>[U(k(e.channelName),1)]),_:2},1032,["style","to"])),h("div",{class:"grid-2 hover",onClick:V=>_.openRead(e.id)},[h("div",re,k(e.title),1),h("small",ue,k(e.summary),1)],8,de)]),a.mobile?w("",!0):(o(),v("small",ce,k(e.pubDate),1))])]),_:2},1032,["value"]))),128)),n.loading?(o(),v(b,{key:0},$(20,e=>l(H,{key:e},{default:s(()=>[h("div",he,[l(c,{height:"0.8em",width:"70%"}),l(c,{height:"0.8em",width:"50px"})])]),_:2},1024)),64)):w("",!0)]),_:1}),!n.loading&&n.isLast?(o(),v("div",_e,"\u6CA1\u6709\u66F4\u591A\u4E86")):w("",!0),l(d,{"model-value":n.showReader,"onUpdate:modelValue":i[0]||(i[0]=e=>t.$emits("update:showReader",e))},{default:s(()=>[B(t.$slots,"default",{},void 0,!0)]),_:3},8,["model-value"])])}const me=N(se,[["render",fe],["__scopeId","data-v-b8989052"]]);function pe(t,i,n=()=>{}){i=i||t;let a=!0;const R=C(0),_=C(0),m=C(0),c=C(!1);return J(t,"scroll",d=>{if(R.value=i.scrollTop,_.value=i.scrollHeight,m.value=i.clientHeight,a){let e=i.scrollTop+i.clientHeight+120>i.scrollHeight;e&&n(),c.value=e,a=!1}setTimeout(()=>{c.value=!1,a=!0},300)}),{scrollTop:R,scrollHeight:_,clientHeight:m,isScrollBottom:c}}const ye={props:{loadMore:{type:Function,default:()=>()=>{}},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showReader:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["click-item-read"],setup(){const{mobile:t}=A();return{mobile:t}},data:()=>({channelRefHeight:0}),mounted(){pe(this.$refs.listRef.$el,null,this.loadMore),this.mobile||setTimeout(()=>{this.$refs.channelRef.clientHeight&&(this.channelRefHeight=this.$refs.channelRef.clientHeight)},1e3)},components:{Skeleton:O},computed:{maxHeight(){return"calc(100vh - "+(this.channelRefHeight+70)+"px)"}},watch:{$route(){this.$refs.listRef.$el.scrollTop=0}},methods:{async openRead(t){this.$emit("click-item-read",t)}}},ve={ref:"channelRef"},ge=["onClick"],we={style:{}},ke=["textContent"],xe=["textContent"],Re={class:"flex"},Ve=["textContent"],be={class:"item"},Ce={class:"flex"},$e={key:1,class:"text-center pa-3"},Ie={class:"box"};function Be(t,i,n,a,R,_){const m=x("router-link"),c=x("skeleton");return o(),g(z,{dense:""},{default:s(()=>[K(l(I,{xl:3,lg:4,md:6,sm:12},{default:s(()=>[l(G,null,{default:s(()=>[h("div",ve,[B(t.$slots,"channel",{},void 0,!0)],512),l(j,{ref:"listRef",variant:"text",class:"over-y",style:P({maxHeight:_.maxHeight})},{default:s(()=>[(o(!0),v(b,null,$(n.data,d=>(o(),g(H,{class:"py-2",key:d.id,value:"article/"+d.id},{default:s(()=>[h("div",{class:"item",onClick:e=>_.openRead(d.id)},[l(D,{src:d.thumbnail?d.thumbnail:"/card-thumb.jpg",class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""},null,8,["src"]),h("div",we,[h("div",{textContent:k(d.title),style:{"font-size":"0.9em"}},null,8,ke),h("small",{style:{display:"block"},textContent:k(d.summary)},null,8,xe),h("div",Re,[t.isChannel?w("",!0):(o(),g(m,{key:0,style:{"font-size":"0.8em"},class:"text-ellipsis",to:"/channel/"+d.channelId},{default:s(()=>[U(k(d.channelName),1)]),_:2},1032,["to"])),h("small",{textContent:k(d.pubDate)},null,8,Ve)])])],8,ge)]),_:2},1032,["value"]))),128)),n.loading?(o(),v(b,{key:0},$(20,d=>l(H,{class:"py-2",key:d},{default:s(()=>[h("div",be,[l(D,{class:"white--text align-end",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"80px",cover:""}),h("div",null,[l(c,{height:"0.8em",width:"calc(1oo% - 100px)"}),l(c,{height:"0.7em",width:"calc(1oo% - 100px)"}),h("div",Ce,[l(c,{height:"0.6em",width:"100px"}),l(c,{height:"0.6em",width:"50px"})])])])]),_:2},1024)),64)):w("",!0),!n.loading&&n.isLast?(o(),v("div",$e,"\u6CA1\u6709\u66F4\u591A\u4E86")):w("",!0)]),_:1},8,["style"])]),_:3})]),_:3},512),[[Q,!(a.mobile&&n.showReader)]]),l(X,{name:"list"},{default:s(()=>[n.showReader?(o(),g(I,{key:0,xl:9,lg:8,md:6,sm:12},{default:s(()=>[h("div",Ie,[B(t.$slots,"default",{},void 0,!0)])]),_:3})):w("",!0)]),_:3})]),_:3})}const He=N(ye,[["render",Be],["__scopeId","data-v-f8f13272"]]),Te={__name:"IndexView",props:["loadMore","data","loading","isLast"],setup(t){const i=t,n=Y("currentViewName"),a=C({}),R=C(void 0),_=i.loadMore,m=M(()=>i.data),c=M(()=>i.loading),d=M(()=>i.isLast),e=Z();F(a,r=>{r.id&&(e.pushHash("/article/"+r.id),document.title=(r.title||"")+" | WebFollow")}),F(R,r=>{V(r)});async function V(r){a.value=await ee(r),a.value.id=r}const W=r=>{let u=a.value.id,f=r.length;for(let y=0;y<f;y++)if(r[y].id==u&&y>0)return r[y-1].id;return null};function q(r){let u=a.value.id,f=r.length;for(let y=0;y<f;y++){let L=r[y];if(L.id==u&&y+3>f&&_(),L.id==u&&y+1<f)return r[y+1].id}return null}return E(async r=>{let u;r.detail=="up"?u=W(m.value):r.detail=="down"&&(u=q(m.value)),u&&V(u)}),(r,u)=>p(n)=="cards-view"?(o(),g(ne,{key:0,loadMore:p(_),data:p(m),loading:p(c),"is-last":p(d),"show-reader":a.value.id,"onUpdate:show-reader":u[1]||(u[1]=f=>a.value.id=f),onClickItemRead:V},{default:s(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):p(n)=="title-only-view"?(o(),g(me,{key:1,loadMore:p(_),data:p(m),loading:p(c),"is-last":p(d),"show-reader":a.value.id,"onUpdate:show-reader":u[3]||(u[3]=f=>a.value.id=f),onClickItemRead:V},{default:s(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=f=>a.value=f),"ctrl-style":"position:fixed"},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","is-last","show-reader"])):(o(),g(He,{key:2,loadMore:p(_),data:p(m),loading:p(c),"show-reader":a.value.id,"is-last":p(d),onClickItemRead:V},{default:s(()=>[l(T,{modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=f=>a.value=f),"over-y":!0},null,8,["modelValue"])]),_:1},8,["loadMore","data","loading","show-reader","is-last"]))}};export{Te as _,pe as u};
