import{h as x,j as B,_ as D,s as E,k as z,l as R,m as y,n as F,p as S,q as I,t as Y,r as q,o as c,c as d,a as s,w as u,v as r,x as H,y as v,z as o,d as A,A as U,B as f,C as $,g as T,D as j,E as Q,F as W}from"./index.48b17015.js";import{V as G}from"./VSnackbar.caf01ee4.js";function J(t){return x.post("/star",null,{params:{itemId:t}})}function K(t){return x.delete("/star",{params:{itemId:t}})}function pe(t){return x.get("/star/articles",{params:t})}function O(t){return x.get("/proxy/html-text",{params:t})}async function P(t,n){return n=="text"?await X(t):n=="html"?await L(t):await L(t)}async function L(t){return(location.hostname.includes("localhost")?"http://localhost:8080/api":"https://api.webfollow.cc/api")+"/proxy/html-text?url="+t}async function X(t){let n=await O({url:t});return Z(n).content}function Z(t){var n=document.implementation.createHTMLDocument("doc");n.documentElement.innerHTML=t;var p=new B.Readability(n.cloneNode(!0)).parse();return p}const ee={class:"ctrl-item",title:"\u52A0\u8F7D\u7F51\u9875\u6587\u672C-\u9605\u8BFB\u6A21\u5F0F \u5FEB\u6377\u952E(ctrl+alt+r)"},te={class:"ctrl-item",title:"\u5185\u5D4C\u7F51\u9875 \u5FEB\u6377\u952E(ctrl+alt+i)"},ae={key:0,class:"ctrl-item",title:"\u6536\u85CF \u5FEB\u6377\u952E(ctrl+alt+s)"},le={class:"ctrl-item",title:"\u5173\u95ED \u5FEB\u6377\u952E(ctrl+alt+q)"},oe={key:0,class:"read"},se=["src"],ne={key:1,class:"read"},ie={class:"mr-3 mt-3"},re=["href"],ce=["textContent"],de={class:"mx-auto"},ue={__name:"Reader",props:["modelValue","overY"],emits:["update:modelValue"],setup(t,{emit:n}){const p=t,{token:M}=E(z()),a=R(()=>p.modelValue),N=R(()=>p.overY),k=y(!1),i=y(void 0),m=F({show:!1,msg:void 0}),_=e=>n("update:modelValue",e);S(()=>{let e=y();I(a,l=>{e&&l.id&&(e.scrollTop=0),i.value&&C(i.value)})});async function V(){let e=a.value;try{e.star?await K(e.id):await J(e.id),e.star=!e.star,_(e)}catch{m.msg="\u51FA\u73B0\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",m.show=!0}}async function h(e){if(e==i.value){let l=a.value;i.value=void 0,l.descriptionText=void 0,_(l);return}await C(e)}async function C(e){let l=a.value;k.value=!0;let w=await P(l.link,e);i.value=e,l.descriptionText=w,_(l),k.value=!1}function b(){_({})}return S(()=>{Y(async e=>{e.detail=="rendText"?h("text"):e.detail=="rendHtml"?h("html"):e.detail=="readerQuit"?b():e.detail=="readerStar"&&V()})}),(e,l)=>{const w=q("router-link");return c(),d(W,null,[s(H,{loading:k.value},{default:u(()=>[r("div",{class:Q(["read-box",{"over-y":o(N)}])},[s(H,{class:"ctrl",width:"50px"},{default:u(()=>[r("div",ee,[s(v,{icon:"mdi:mdi-book-open",color:i.value=="text"?"indigo":"",onClick:l[0]||(l[0]=g=>h("text"))},null,8,["color"])]),r("div",te,[s(v,{icon:"mdi:mdi-google-chrome",color:i.value=="html"?"indigo":"",onClick:l[1]||(l[1]=g=>h("html"))},null,8,["color"])]),o(M)?(c(),d("div",ae,[s(v,{icon:"mdi:mdi-star"+(o(a).star?"":"-outline"),variant:"outlined",color:o(a).star?"indigo":"",onClick:V},null,8,["icon","color"])])):A("",!0),r("div",le,[s(v,{icon:"mdi:mdi-close",onClick:b})])]),_:1}),i.value=="html"?(c(),d("div",oe,[r("iframe",{src:o(a).descriptionText,frameborder:"0",class:"read-box",width:"100%"},null,8,se)])):(c(),d("div",ne,[r("div",null,[r("div",ie,[s(U,{class:"text-ellipsis",style:{"max-width":"90%","font-size":"2em"}},{default:u(()=>[o(a).link?(c(),d("a",{key:0,target:"_blank",href:o(a).link},f(o(a).title),9,re)):(c(),d("span",{key:1,textContent:f(o(a).title)},null,8,ce))]),_:1})]),s($,{class:"mb-2 mt-1"},{default:u(()=>[s(w,{to:"/channel/"+o(a).channelId},{default:u(()=>[T(f(o(a).channelName),1)]),_:1},8,["to"]),T(" "+f(o(a).pubDateTime),1)]),_:1})]),r("div",de,[s(j,{innerHTML:o(a).descriptionText||o(a).description,class:"read-warp"},null,8,["innerHTML"])])]))],2)]),_:1},8,["loading"]),s(G,{location:"top",timeout:2e3,modelValue:m.show,"onUpdate:modelValue":l[2]||(l[2]=g=>m.show=g)},{default:u(()=>[T(f(m.msg),1)]),_:1},8,["modelValue"])],64)}}},_e=D(ue,[["__scopeId","data-v-6f48805f"]]);export{_e as R,pe as f};
