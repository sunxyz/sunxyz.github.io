import{V as S,a as F,l as L}from"./VLayout.33e2f988.js";import{_ as U,a as E,au as D,b as K,p as N,x as u,y as J,o as r,c as M,d as t,w as l,F as P,bJ as R,bK as j,J as z,C as y,t as c,bL as A,bM as I,D as W,e as m,L as _,K as q,j as p,h as G}from"./index.0ccad02f.js";import{V as H}from"./VSnackbar.b283bf7b.js";import{b}from"./VTextField.d37a5a1c.js";const O={setup(){const{setUserInfo:V}=E(),{reloadFollow:s}=D(),{t:h}=K();function e(d){return h("login."+d)}const v=N(),n=u(void 0),a=J({show:!1,text:void 0}),f=u(0),x=u(void 0),o=u(!1),i=u(void 0);let g="";async function w(){f.value==0?k():C()}async function k(){if(o.value=!0,n.value)try{i.value=e("tip.sendingEmal"),g=await F({email:n.value}),f.value=1,setTimeout(()=>{i.value=void 0},2e3),o.value=!1}catch{a.text=e("tip.sendErr"),a.show=!0,o.value=!1}else a.text=e("tip.sendCheck"),a.show=!0,o.value=!1}async function C(){if(o.value=!0,x.value)try{i.value=e("tip.logining");let d=await L({key:g,code:x.value});T(d,()=>{setTimeout(()=>{v.push("/")},2e3)}),i.value=e("tip.loginSuc"),o.value=!1}catch{a.text=e("tip.loginErr"),a.show=!0,o.value=!1}else a.text=e("tip.codeCheck"),a.show=!0,o.value=!1}async function T(d,B){V({username:n.value},d),s(),B()}return{step:f,email:n,code:x,tip:a,loading:o,authText:i,loginSubmit:w,st:e}}},Q={style:{display:"flex","align-items":"end"}},X=y("div",{class:"mr-6"},"WebFollow",-1);function Y(V,s,h,e,v,n){return r(),M(P,null,[t(S,null,{default:l(()=>[t(R,{color:"primary",density:"prominent"},{default:l(()=>[t(j,{class:"mx-auto","max-width":"1024px"},{default:l(()=>[t(z,{class:"mt-6"},{default:l(()=>[y("div",Q,[X,y("small",null,c(e.st("title")),1)])]),_:1})]),_:1})]),_:1}),t(A,null,{default:l(()=>[t(I,null,{default:l(()=>[t(W,{"max-width":"480px",class:"mx-auto",style:{"margin-top":"-36px","z-index":"10000"}},{default:l(()=>[e.authText?(r(),m(_,{key:0,textContent:c(e.authText),class:"my-12 text-align"},null,8,["textContent"])):(r(),m(_,{key:1},{default:l(()=>[t(q,{class:"mt-3"},{default:l(()=>[p(c(e.st("subTitle")),1)]),_:1}),e.step==0?(r(),m(b,{key:0,"hide-details":"auto",label:e.st("email"),placeholder:e.st("emailPlaceholder"),type:"email",class:"my-4",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=a=>e.email=a)},null,8,["label","placeholder","modelValue"])):(r(),m(b,{key:1,"hide-details":"auto",label:e.st("code"),placeholder:e.st("codePlaceholder"),type:"text",class:"my-4",modelValue:e.code,"onUpdate:modelValue":s[1]||(s[1]=a=>e.code=a)},null,8,["label","placeholder","modelValue"])),t(G,{block:"",color:"primary",loading:e.loading,onClick:e.loginSubmit},{default:l(()=>[p(c(e.step==0?e.st("emailBtn"):e.st("loginBtn")),1)]),_:1},8,["loading","onClick"])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(H,{modelValue:e.tip.show,"onUpdate:modelValue":s[2]||(s[2]=a=>e.tip.show=a)},{default:l(()=>[p(c(e.tip.text),1)]),_:1},8,["modelValue"])],64)}const le=U(O,[["render",Y]]);export{le as default};
