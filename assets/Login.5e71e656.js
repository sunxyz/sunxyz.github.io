import{V as S,a as F,l as U}from"./VLayout.ac28585c.js";import{_ as E,a as L,at as N,b as D,n as I,v as r,x as K,o as u,c as M,d as t,w as l,F as P,bL as R,bM as j,I as z,B as V,t as c,bN as A,bO as J,C as O,e as m,K as _,J as W,j as p,h as q}from"./index.e3879f0a.js";import{V as G}from"./VSnackbar.2be2db85.js";import{b}from"./VTextField.3ea08254.js";const H={setup(){const{setUserInfo:h}=L(),{reloadFollow:s}=N(),{t:y}=D();function e(d){return y("login."+d)}const v=I(),n=r(void 0),a=K({show:!1,text:void 0}),f=r(0),x=r(void 0),o=r(!1),i=r(void 0);let g="";async function w(){f.value==0?k():C()}async function k(){if(o.value=!0,n.value)try{i.value=e("tip.sendingEmal"),g=await F({email:n.value}),f.value=1,setTimeout(()=>{i.value=void 0},2e3),o.value=!1}catch{a.text=e("tip.sendErr"),a.show=!0,o.value=!1}else a.text=e("tip.sendCheck"),a.show=!0,o.value=!1}async function C(){if(o.value=!0,x.value)try{i.value=e("tip.logining");let d=await U({key:g,code:x.value});T(d,()=>{setTimeout(()=>{v.push("/")},2e3)}),i.value=e("tip.loginSuc"),o.value=!1}catch{a.text=e("tip.loginErr"),a.show=!0,o.value=!1}else a.text=e("tip.codeCheck"),a.show=!0,o.value=!1}async function T(d,B){h({username:n.value},d),s(),B()}return{step:f,email:n,code:x,tip:a,loading:o,authText:i,loginSubmit:w,st:e}}},Q={style:{display:"flex","align-items":"end"}},X=V("div",{class:"mr-6"},"WebFollow",-1);function Y(h,s,y,e,v,n){return u(),M(P,null,[t(S,null,{default:l(()=>[t(R,{color:"primary",density:"prominent"},{default:l(()=>[t(j,{class:"mx-auto","max-width":"1024px"},{default:l(()=>[t(z,{class:"mt-6"},{default:l(()=>[V("div",Q,[X,V("small",null,c(e.st("title")),1)])]),_:1})]),_:1})]),_:1}),t(A,null,{default:l(()=>[t(J,null,{default:l(()=>[t(O,{"max-width":"480px",class:"mx-auto",style:{"margin-top":"-36px","z-index":"10000"}},{default:l(()=>[e.authText?(u(),m(_,{key:0,textContent:c(e.authText),class:"my-12 text-align"},null,8,["textContent"])):(u(),m(_,{key:1},{default:l(()=>[t(W,{class:"mt-3"},{default:l(()=>[p(c(e.st("subTitle")),1)]),_:1}),e.step==0?(u(),m(b,{key:0,"hide-details":"auto",label:e.st("email"),placeholder:e.st("emailPlaceholder"),type:"email",class:"my-4",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=a=>e.email=a)},null,8,["label","placeholder","modelValue"])):(u(),m(b,{key:1,"hide-details":"auto",label:e.st("code"),placeholder:e.st("codePlaceholder"),type:"text",class:"my-4",modelValue:e.code,"onUpdate:modelValue":s[1]||(s[1]=a=>e.code=a)},null,8,["label","placeholder","modelValue"])),t(q,{block:"",color:"primary",loading:e.loading,onClick:e.loginSubmit},{default:l(()=>[p(c(e.step==0?e.st("emailBtn"):e.st("loginBtn")),1)]),_:1},8,["loading","onClick"])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(G,{modelValue:e.tip.show,"onUpdate:modelValue":s[2]||(s[2]=a=>e.tip.show=a)},{default:l(()=>[p(c(e.tip.text),1)]),_:1},8,["modelValue"])],64)}const le=E(H,[["render",Y]]);export{le as default};
